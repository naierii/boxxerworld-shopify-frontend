"use strict";(self.webpackChunkboxxerworld_customiser=self.webpackChunkboxxerworld_customiser||[]).push([[204],{6204:function(e,t,r){r.r(t),r.d(t,{default:function(){return cr}});var n=r(5893),a=r(1447),o=r(4864),i=r(7294),s=r(9477);const l=new WeakMap;class u extends s.Loader{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,n){const a=new s.FileLoader(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(e=>{const r={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,r).then(t).catch(n)}),r,n)}decodeDracoFile(e,t,r,n){const a={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,a).then(t)}decodeGeometry(e,t){for(const e in t.attributeTypes){const r=t.attributeTypes[e];void 0!==r.BYTES_PER_ELEMENT&&(t.attributeTypes[e]=r.name)}const r=JSON.stringify(t);if(l.has(e)){const t=l.get(e);if(t.key===r)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n;const a=this.workerNextTaskID++,o=e.byteLength,i=this._getWorker(a,o).then((r=>(n=r,new Promise(((r,o)=>{n._callbacks[a]={resolve:r,reject:o},n.postMessage({type:"decode",id:a,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return i.catch((()=>!0)).then((()=>{n&&a&&this._releaseTask(n,a)})),l.set(e,{key:r,promise:i}),i}_createGeometry(e){const t=new s.BufferGeometry;e.index&&t.setIndex(new s.BufferAttribute(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r],a=n.name,o=n.array,i=n.itemSize;t.setAttribute(a,new s.BufferAttribute(o,i))}return t}_loadLibrary(e,t){const r=new s.FileLoader(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise(((t,n)=>{r.load(e,t,void 0,n)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const n=c.toString(),a=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([a]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function c(){let e,t;function r(e,t,r,n,a,o){const i=o.num_components(),s=r.num_points()*i,l=s*a.BYTES_PER_ELEMENT,u=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,a),c=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,o,u,l,c);const d=new a(e.HEAPF32.buffer,c,s).slice();return e._free(c),{name:n,array:d,itemSize:i}}onmessage=function(n){const a=n.data;switch(a.type){case"init":e=a.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const n=a.buffer,o=a.taskConfig;t.then((e=>{const t=e.draco,i=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(n),n.byteLength);try{const e=function(e,t,n,a){const o=a.attributeIDs,i=a.attributeTypes;let s,l;const u=t.GetEncodedGeometryType(n);if(u===e.TRIANGULAR_MESH)s=new e.Mesh,l=t.DecodeBufferToMesh(n,s);else{if(u!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");s=new e.PointCloud,l=t.DecodeBufferToPointCloud(n,s)}if(!l.ok()||0===s.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const c={index:null,attributes:[]};for(const n in o){const l=self[i[n]];let u,d;if(a.useUniqueIDs)d=o[n],u=t.GetAttributeByUniqueId(s,d);else{if(d=t.GetAttributeId(s,e[o[n]]),-1===d)continue;u=t.GetAttribute(s,d)}c.attributes.push(r(e,t,s,n,l,u))}u===e.TRIANGULAR_MESH&&(c.index=function(e,t,r){const n=3*r.num_faces(),a=4*n,o=e._malloc(a);t.GetTrianglesUInt32Array(r,a,o);const i=new Uint32Array(e.HEAPF32.buffer,o,n).slice();return e._free(o),{array:i,itemSize:1}}(e,t,s));return e.destroy(s),c}(t,i,s,o),n=e.attributes.map((e=>e.array.buffer));e.index&&n.push(e.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:e},n)}catch(e){console.error(e),self.postMessage({type:"error",id:a.id,error:e.message})}finally{t.destroy(s),t.destroy(i)}}))}}}let d;const f=()=>{if(d)return d;const e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!=typeof WebAssembly)return{supported:!1};let r,n="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";WebAssembly.validate(e)&&(n="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");const a=WebAssembly.instantiate(function(e){const r=new Uint8Array(e.length);for(let t=0;t<e.length;++t){const n=e.charCodeAt(t);r[t]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}let n=0;for(let a=0;a<e.length;++a)r[n++]=r[a]<60?t[r[a]]:64*(r[a]-60)+r[++a];return r.buffer.slice(0,n)}(n),{}).then((e=>{r=e.instance,r.exports.__wasm_call_ctors()}));function o(e,t,n,a,o,i){const s=r.exports.sbrk,l=n+3&-4,u=s(l*a),c=s(o.length),d=new Uint8Array(r.exports.memory.buffer);d.set(o,c);const f=e(u,n,a,c,o.length);if(0===f&&i&&i(u,l,a),t.set(d.subarray(u,u+n*a)),s(u-s(0)),0!==f)throw new Error(`Malformed buffer data: ${f}`)}const i={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},s={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return d={ready:a,supported:!0,decodeVertexBuffer(e,t,n,a,s){o(r.exports.meshopt_decodeVertexBuffer,e,t,n,a,r.exports[i[s]])},decodeIndexBuffer(e,t,n,a){o(r.exports.meshopt_decodeIndexBuffer,e,t,n,a)},decodeIndexSequence(e,t,n,a){o(r.exports.meshopt_decodeIndexSequence,e,t,n,a)},decodeGltfBuffer(e,t,n,a,l,u){o(r.exports[s[l]],e,t,n,a,r.exports[i[u]])}},d};class h extends s.Loader{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new v(e)})),this.register((function(e){return new E(e)})),this.register((function(e){return new x(e)})),this.register((function(e){return new y(e)})),this.register((function(e){return new b(e)})),this.register((function(e){return new F(e)})),this.register((function(e){return new M(e)})),this.register((function(e){return new g(e)})),this.register((function(e){return new G(e)})),this.register((function(e){return new C(e)})),this.register((function(e){return new B(e)})),this.register((function(e){return new T(e)}))}load(e,t,r,n){const a=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:s.LoaderUtils.extractUrlBase(e),this.manager.itemStart(e);const i=function(t){n?n(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},l=new s.FileLoader(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(function(r){try{a.parse(r,o,(function(r){t(r),a.manager.itemEnd(e)}),i)}catch(e){i(e)}}),r,i)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,n){let a;const o={},i={};if("string"==typeof e)a=e;else{if(s.LoaderUtils.decodeText(new Uint8Array(e,0,4))===S){try{o[p.KHR_BINARY_GLTF]=new I(e)}catch(e){return void(n&&n(e))}a=o[p.KHR_BINARY_GLTF].content}else a=s.LoaderUtils.decodeText(new Uint8Array(e))}const l=JSON.parse(a);if(void 0===l.asset||l.asset.version[0]<2)return void(n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const u=new ce(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](u);i[t.name]=t,o[t.name]=!0}if(l.extensionsUsed)for(let e=0;e<l.extensionsUsed.length;++e){const t=l.extensionsUsed[e],r=l.extensionsRequired||[];switch(t){case p.KHR_MATERIALS_UNLIT:o[t]=new m;break;case p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[t]=new k;break;case p.KHR_DRACO_MESH_COMPRESSION:o[t]=new U(l,this.dracoLoader);break;case p.KHR_TEXTURE_TRANSFORM:o[t]=new w;break;case p.KHR_MESH_QUANTIZATION:o[t]=new _;break;default:r.indexOf(t)>=0&&void 0===i[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}u.setExtensions(o),u.setPlugins(i),u.parse(r,n)}parseAsync(e,t){const r=this;return new Promise((function(n,a){r.parse(e,t,n,a)}))}}function A(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const p={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class B{constructor(e){this.parser=e,this.name=p.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,n=t.length;r<n;r++){const n=t[r];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let n=t.cache.get(r);if(n)return n;const a=t.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let i;const l=new s.Color(16777215);void 0!==o.color&&l.fromArray(o.color);const u=void 0!==o.range?o.range:0;switch(o.type){case"directional":i=new s.DirectionalLight(l),i.target.position.set(0,0,-1),i.add(i.target);break;case"point":i=new s.PointLight(l),i.distance=u;break;case"spot":i=new s.SpotLight(l),i.distance=u,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,i.angle=o.spot.outerConeAngle,i.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return i.position.set(0,0,0),i.decay=2,void 0!==o.intensity&&(i.intensity=o.intensity),i.name=t.createUniqueName(o.name||"light_"+e),n=Promise.resolve(i),t.cache.add(r,n),n}createNodeAttachment(e){const t=this,r=this.parser,n=r.json.nodes[e],a=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then((function(e){return r._getNodeRef(t.cache,a,e)}))}}class m{constructor(){this.name=p.KHR_MATERIALS_UNLIT}getMaterialType(){return s.MeshBasicMaterial}extendParams(e,t,r){const n=[];e.color=new s.Color(1,1,1),e.opacity=1;const a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const t=a.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==a.baseColorTexture&&n.push(r.assignTexture(e,"map",a.baseColorTexture,s.sRGBEncoding))}return Promise.all(n)}}class g{constructor(e){this.parser=e,this.name=p.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const n=r.extensions[this.name].emissiveStrength;return void 0!==n&&(t.emissiveIntensity=n),Promise.resolve()}}class v{constructor(e){this.parser=e,this.name=p.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const a=[],o=n.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&a.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&a.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(a.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const e=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new s.Vector2(e,e)}return Promise.all(a)}}class C{constructor(e){this.parser=e,this.name=p.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const a=[],o=n.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&a.push(r.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&a.push(r.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(a)}}class y{constructor(e){this.parser=e,this.name=p.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const a=[];t.sheenColor=new s.Color(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=n.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&a.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture,s.sRGBEncoding)),void 0!==o.sheenRoughnessTexture&&a.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(a)}}class b{constructor(e){this.parser=e,this.name=p.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const a=[],o=n.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&a.push(r.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(a)}}class F{constructor(e){this.parser=e,this.name=p.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const a=[],o=n.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&a.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const i=o.attenuationColor||[1,1,1];return t.attenuationColor=new s.Color(i[0],i[1],i[2]),Promise.all(a)}}class M{constructor(e){this.parser=e,this.name=p.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const n=r.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}}class G{constructor(e){this.parser=e,this.name=p.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const a=[],o=n.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&a.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));const i=o.specularColorFactor||[1,1,1];return t.specularColor=new s.Color(i[0],i[1],i[2]),void 0!==o.specularColorTexture&&a.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture,s.sRGBEncoding)),Promise.all(a)}}class E{constructor(e){this.parser=e,this.name=p.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const a=n.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a.source,o)}}class x{constructor(e){this.parser=e,this.name=p.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,n=r.json,a=n.textures[e];if(!a.extensions||!a.extensions[t])return null;const o=a.extensions[t],i=n.images[o.source];let s=r.textureLoader;if(i.uri){const e=r.options.manager.getHandler(i.uri);null!==e&&(s=e)}return this.detectSupport().then((function(a){if(a)return r.loadTextureImage(e,o.source,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class T{constructor(e){this.name=p.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const e=r.extensions[this.name],n=this.parser.getDependency("buffer",e.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return n.then((function(t){const r=e.byteOffset||0,n=e.byteLength||0,o=e.count,i=e.byteStride,s=new Uint8Array(t,r,n);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(o,i,s,e.mode,e.filter).then((function(e){return e.buffer})):a.ready.then((function(){const t=new ArrayBuffer(o*i);return a.decodeGltfBuffer(new Uint8Array(t),o,i,s,e.mode,e.filter),t}))}))}return null}}const S="glTF",D=1313821514,R=5130562;class I{constructor(e){this.name=p.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:s.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==S)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,n=new DataView(e,12);let a=0;for(;a<r;){const t=n.getUint32(a,!0);a+=4;const r=n.getUint32(a,!0);if(a+=4,r===D){const r=new Uint8Array(e,12+a,t);this.content=s.LoaderUtils.decodeText(r)}else if(r===R){const r=12+a;this.body=e.slice(r,r+t)}a+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class U{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=p.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,n=this.dracoLoader,a=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,i={},s={},l={};for(const e in o){const t=q[e]||e.toLowerCase();i[t]=o[e]}for(const t in e.attributes){const n=q[t]||t.toLowerCase();if(void 0!==o[t]){const a=r.accessors[e.attributes[t]],o=Y[a.componentType];l[n]=o.name,s[n]=!0===a.normalized}}return t.getDependency("bufferView",a).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(const t in e.attributes){const r=e.attributes[t],n=s[t];void 0!==n&&(r.normalized=n)}t(e)}),i,l)}))}))}}class w{constructor(){this.name=p.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class H extends s.MeshStandardMaterial{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),a=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),i={specular:{value:(new s.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=i,this.onBeforeCompile=function(e){for(const t in i)e.uniforms[t]=i[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",r).replace("#include <roughnessmap_fragment>",n).replace("#include <metalnessmap_fragment>",a).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return i.specular.value},set:function(e){i.specular.value=e}},specularMap:{get:function(){return i.specularMap.value},set:function(e){i.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return i.glossiness.value},set:function(e){i.glossiness.value=e}},glossinessMap:{get:function(){return i.glossinessMap.value},set:function(e){i.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class k{constructor(){this.name=p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return H}extendParams(e,t,r){const n=t.extensions[this.name];e.color=new s.Color(1,1,1),e.opacity=1;const a=[];if(Array.isArray(n.diffuseFactor)){const t=n.diffuseFactor;e.color.fromArray(t),e.opacity=t[3]}if(void 0!==n.diffuseTexture&&a.push(r.assignTexture(e,"map",n.diffuseTexture,s.sRGBEncoding)),e.emissive=new s.Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new s.Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){const t=n.specularGlossinessTexture;a.push(r.assignTexture(e,"glossinessMap",t)),a.push(r.assignTexture(e,"specularMap",t,s.sRGBEncoding))}return Promise.all(a)}createMaterial(e){const t=new H(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=void 0===e.emissiveIntensity?1:e.emissiveIntensity,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=s.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}class _{constructor(){this.name=p.KHR_MESH_QUANTIZATION}}class L extends s.Interpolant{constructor(e,t,r,n){super(e,t,r,n)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,a=e*n*3+n;for(let e=0;e!==n;e++)t[e]=r[a+e];return t}interpolate_(e,t,r,n){const a=this.resultBuffer,o=this.sampleValues,i=this.valueSize,s=2*i,l=3*i,u=n-t,c=(r-t)/u,d=c*c,f=d*c,h=e*l,A=h-l,p=-2*f+3*d,B=f-d,m=1-p,g=B-d+c;for(let e=0;e!==i;e++){const t=o[A+e+i],r=o[A+e+s]*u,n=o[h+e+i],l=o[h+e]*u;a[e]=m*t+g*r+p*n+B*l}return a}}const O=new s.Quaternion;class P extends L{interpolate_(e,t,r,n){const a=super.interpolate_(e,t,r,n);return O.fromArray(a).normalize().toArray(a),a}}const J=0,K=1,N=2,j=3,Q=4,X=5,W=6,Y={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},V={9728:s.NearestFilter,9729:s.LinearFilter,9984:s.NearestMipmapNearestFilter,9985:s.LinearMipmapNearestFilter,9986:s.NearestMipmapLinearFilter,9987:s.LinearMipmapLinearFilter},Z={33071:s.ClampToEdgeWrapping,33648:s.MirroredRepeatWrapping,10497:s.RepeatWrapping},z={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},q={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},$={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ee={CUBICSPLINE:void 0,LINEAR:s.InterpolateLinear,STEP:s.InterpolateDiscrete},te="OPAQUE",re="MASK",ne="BLEND";function ae(e,t,r){for(const n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function oe(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function ie(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){const r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,n=r.length;t<n;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function se(e){const t=e.extensions&&e.extensions[p.KHR_DRACO_MESH_COMPRESSION];let r;return r=t?"draco:"+t.bufferView+":"+t.indices+":"+le(t.attributes):e.indices+":"+le(e.attributes)+":"+e.mode,r}function le(e){let t="";const r=Object.keys(e).sort();for(let n=0,a=r.length;n<a;n++)t+=r[n]+":"+e[r[n]]+";";return t}function ue(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class ce{constructor(e={},t={}){var r,n;this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new A,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const a="undefined"!=typeof navigator&&!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),o="undefined"!=typeof navigator&&(null===(r=navigator.userAgent)||void 0===r?void 0:r.indexOf("Firefox"))>-1,i="undefined"!=typeof navigator&&o?null===(n=navigator.userAgent)||void 0===n?void 0:n.match(/Firefox\/([0-9]+)\./)[1]:-1;"undefined"==typeof createImageBitmap||a||o&&i<98?this.textureLoader=new s.TextureLoader(this.options.manager):this.textureLoader=new s.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new s.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,n=this.json,a=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){const o={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};ae(a,o,n),oe(o,n),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(o)}))).then((function(){e(o)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,n=t.length;r<n;r++){const n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let t=0,n=e.length;t<n;t++){const n=e[t];void 0!==n.mesh&&(this._addNodeRef(this.meshCache,n.mesh),void 0!==n.skin&&(r[n.mesh].isSkinnedMesh=!0)),void 0!==n.camera&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const n=r.clone(),a=(e,t)=>{const r=this.associations.get(e);null!=r&&this.associations.set(t,r);for(const[r,n]of e.children.entries())a(n,t.children[r])};return a(r,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const n=e(t[r]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let n=0;n<t.length;n++){const a=e(t[n]);a&&r.push(a)}return r}getDependency(e,t){const r=e+":"+t;let n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":n=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":n=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[p.KHR_BINARY_GLTF].body);const n=this.options;return new Promise((function(e,a){r.load(s.LoaderUtils.resolveURL(t.uri,n.path),e,void 0,(function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))}loadAccessor(e){const t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);const a=[];return void 0!==n.bufferView?a.push(this.getDependency("bufferView",n.bufferView)):a.push(null),void 0!==n.sparse&&(a.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(a).then((function(e){const a=e[0],o=z[n.type],i=Y[n.componentType],l=i.BYTES_PER_ELEMENT,u=l*o,c=n.byteOffset||0,d=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,f=!0===n.normalized;let h,A;if(d&&d!==u){const e=Math.floor(c/d),r="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+e+":"+n.count;let u=t.cache.get(r);u||(h=new i(a,e*d,n.count*d/l),u=new s.InterleavedBuffer(h,d/l),t.cache.add(r,u)),A=new s.InterleavedBufferAttribute(u,o,c%d/l,f)}else h=null===a?new i(n.count*o):new i(a,c,n.count*o),A=new s.BufferAttribute(h,o,f);if(void 0!==n.sparse){const t=z.SCALAR,r=Y[n.sparse.indices.componentType],l=n.sparse.indices.byteOffset||0,u=n.sparse.values.byteOffset||0,c=new r(e[1],l,n.sparse.count*t),d=new i(e[2],u,n.sparse.count*o);null!==a&&(A=new s.BufferAttribute(A.array.slice(),A.itemSize,A.normalized));for(let e=0,t=c.length;e<t;e++){const t=c[e];if(A.setX(t,d[e*o]),o>=2&&A.setY(t,d[e*o+1]),o>=3&&A.setZ(t,d[e*o+2]),o>=4&&A.setW(t,d[e*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return A}))}loadTexture(e){const t=this.json,r=this.options,n=t.textures[e].source,a=t.images[n];let o=this.textureLoader;if(a.uri){const e=r.manager.getHandler(a.uri);null!==e&&(o=e)}return this.loadTextureImage(e,n,o)}loadTextureImage(e,t,r){const n=this,a=this.json,o=a.textures[e],i=a.images[t],l=(i.uri||i.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,r).then((function(t){t.flipY=!1,o.name&&(t.name=o.name);const r=(a.samplers||{})[o.sampler]||{};return t.magFilter=V[r.magFilter]||s.LinearFilter,t.minFilter=V[r.minFilter]||s.LinearMipmapLinearFilter,t.wrapS=Z[r.wrapS]||s.RepeatWrapping,t.wrapT=Z[r.wrapT]||s.RepeatWrapping,n.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[l]=u,u}loadImageSource(e,t){const r=this,n=this.json,a=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const o=n.images[e],i=self.URL||self.webkitURL;let l=o.uri||"",u=!1;if(void 0!==o.bufferView)l=r.getDependency("bufferView",o.bufferView).then((function(e){u=!0;const t=new Blob([e],{type:o.mimeType});return l=i.createObjectURL(t),l}));else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(l).then((function(e){return new Promise((function(r,n){let o=r;!0===t.isImageBitmapLoader&&(o=function(e){const t=new s.Texture(e);t.needsUpdate=!0,r(t)}),t.load(s.LoaderUtils.resolveURL(e,a.path),o,void 0,n)}))})).then((function(e){var t;return!0===u&&i.revokeObjectURL(l),e.userData.mimeType=o.mimeType||((t=o.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),e}));return this.sourceCache[e]=c,c}assignTexture(e,t,r,n){const a=this;return this.getDependency("texture",r.index).then((function(o){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===t&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),a.extensions[p.KHR_TEXTURE_TRANSFORM]){const e=void 0!==r.extensions?r.extensions[p.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=a.associations.get(o);o=a.extensions[p.KHR_TEXTURE_TRANSFORM].extendTexture(o,e),a.associations.set(o,t)}}return void 0!==n&&(o.encoding=n),e[t]=o,o}))}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const n=void 0===t.attributes.tangent,a=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+r.uuid;let t=this.cache.get(e);t||(t=new s.PointsMaterial,s.Material.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){const e="LineBasicMaterial:"+r.uuid;let t=this.cache.get(e);t||(t=new s.LineBasicMaterial,s.Material.prototype.copy.call(t,r),t.color.copy(r.color),this.cache.add(e,t)),r=t}if(n||a||o){let e="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(e+="specular-glossiness:"),n&&(e+="derivative-tangents:"),a&&(e+="vertex-colors:"),o&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),a&&(t.vertexColors=!0),o&&(t.flatShading=!0),n&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=r}getMaterialType(){return s.MeshStandardMaterial}loadMaterial(e){const t=this,r=this.json,n=this.extensions,a=r.materials[e];let o;const i={},l=a.extensions||{},u=[];if(l[p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const e=n[p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=e.getMaterialType(),u.push(e.extendParams(i,a,t))}else if(l[p.KHR_MATERIALS_UNLIT]){const e=n[p.KHR_MATERIALS_UNLIT];o=e.getMaterialType(),u.push(e.extendParams(i,a,t))}else{const r=a.pbrMetallicRoughness||{};if(i.color=new s.Color(1,1,1),i.opacity=1,Array.isArray(r.baseColorFactor)){const e=r.baseColorFactor;i.color.fromArray(e),i.opacity=e[3]}void 0!==r.baseColorTexture&&u.push(t.assignTexture(i,"map",r.baseColorTexture,s.sRGBEncoding)),i.metalness=void 0!==r.metallicFactor?r.metallicFactor:1,i.roughness=void 0!==r.roughnessFactor?r.roughnessFactor:1,void 0!==r.metallicRoughnessTexture&&(u.push(t.assignTexture(i,"metalnessMap",r.metallicRoughnessTexture)),u.push(t.assignTexture(i,"roughnessMap",r.metallicRoughnessTexture))),o=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),u.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,i)}))))}!0===a.doubleSided&&(i.side=s.DoubleSide);const c=a.alphaMode||te;if(c===ne?(i.transparent=!0,i.depthWrite=!1):(i.transparent=!1,c===re&&(i.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&o!==s.MeshBasicMaterial&&(u.push(t.assignTexture(i,"normalMap",a.normalTexture)),i.normalScale=new s.Vector2(1,1),void 0!==a.normalTexture.scale)){const e=a.normalTexture.scale;i.normalScale.set(e,e)}return void 0!==a.occlusionTexture&&o!==s.MeshBasicMaterial&&(u.push(t.assignTexture(i,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(i.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&o!==s.MeshBasicMaterial&&(i.emissive=(new s.Color).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&o!==s.MeshBasicMaterial&&u.push(t.assignTexture(i,"emissiveMap",a.emissiveTexture,s.sRGBEncoding)),Promise.all(u).then((function(){let r;return r=o===H?n[p.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(i):new o(i),a.name&&(r.name=a.name),oe(r,a),t.associations.set(r,{materials:e}),a.extensions&&ae(n,r,a),r}))}createUniqueName(e){const t=s.PropertyBinding.sanitizeNodeName(e||"");let r=t;for(let e=1;this.nodeNamesUsed[r];++e)r=t+"_"+e;return this.nodeNamesUsed[r]=!0,r}loadGeometries(e){const t=this,r=this.extensions,n=this.primitiveCache;function a(e){return r[p.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return fe(r,e,t)}))}const o=[];for(let r=0,i=e.length;r<i;r++){const i=e[r],l=se(i),u=n[l];if(u)o.push(u.promise);else{let e;e=i.extensions&&i.extensions[p.KHR_DRACO_MESH_COMPRESSION]?a(i):fe(new s.BufferGeometry,i,t),n[l]={primitive:i,promise:e},o.push(e)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.json,n=this.extensions,a=r.meshes[e],o=a.primitives,i=[];for(let e=0,t=o.length;e<t;e++){const t=void 0===o[e].material?(void 0===(l=this.cache).DefaultMaterial&&(l.DefaultMaterial=new s.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:s.FrontSide})),l.DefaultMaterial):this.getDependency("material",o[e].material);i.push(t)}var l;return i.push(t.loadGeometries(o)),Promise.all(i).then((function(r){const i=r.slice(0,r.length-1),l=r[r.length-1],u=[];for(let r=0,c=l.length;r<c;r++){const c=l[r],d=o[r];let f;const h=i[r];if(d.mode===Q||d.mode===X||d.mode===W||void 0===d.mode)f=!0===a.isSkinnedMesh?new s.SkinnedMesh(c,h):new s.Mesh(c,h),!0!==f.isSkinnedMesh||f.geometry.attributes.skinWeight.normalized||f.normalizeSkinWeights(),d.mode===X?f.geometry=he(f.geometry,s.TriangleStripDrawMode):d.mode===W&&(f.geometry=he(f.geometry,s.TriangleFanDrawMode));else if(d.mode===K)f=new s.LineSegments(c,h);else if(d.mode===j)f=new s.Line(c,h);else if(d.mode===N)f=new s.LineLoop(c,h);else{if(d.mode!==J)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);f=new s.Points(c,h)}Object.keys(f.geometry.morphAttributes).length>0&&ie(f,a),f.name=t.createUniqueName(a.name||"mesh_"+e),oe(f,a),d.extensions&&ae(n,f,d),t.assignFinalMaterial(f),u.push(f)}for(let r=0,n=u.length;r<n;r++)t.associations.set(u[r],{meshes:e,primitives:r});if(1===u.length)return u[0];const c=new s.Group;t.associations.set(c,{meshes:e});for(let e=0,t=u.length;e<t;e++)c.add(u[e]);return c}))}loadCamera(e){let t;const r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new s.PerspectiveCamera(s.MathUtils.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new s.OrthographicCamera(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),oe(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))}loadAnimation(e){const t=this.json.animations[e],r=[],n=[],a=[],o=[],i=[];for(let e=0,s=t.channels.length;e<s;e++){const s=t.channels[e],l=t.samplers[s.sampler],u=s.target,c=u.node,d=void 0!==t.parameters?t.parameters[l.input]:l.input,f=void 0!==t.parameters?t.parameters[l.output]:l.output;r.push(this.getDependency("node",c)),n.push(this.getDependency("accessor",d)),a.push(this.getDependency("accessor",f)),o.push(l),i.push(u)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(a),Promise.all(o),Promise.all(i)]).then((function(r){const n=r[0],a=r[1],o=r[2],i=r[3],l=r[4],u=[];for(let e=0,t=n.length;e<t;e++){const t=n[e],r=a[e],c=o[e],d=i[e],f=l[e];if(void 0===t)continue;let h;switch(t.updateMatrix(),$[f.path]){case $.weights:h=s.NumberKeyframeTrack;break;case $.rotation:h=s.QuaternionKeyframeTrack;break;default:h=s.VectorKeyframeTrack}const A=t.name?t.name:t.uuid,p=void 0!==d.interpolation?ee[d.interpolation]:s.InterpolateLinear,B=[];$[f.path]===$.weights?t.traverse((function(e){e.morphTargetInfluences&&B.push(e.name?e.name:e.uuid)})):B.push(A);let m=c.array;if(c.normalized){const e=ue(m.constructor),t=new Float32Array(m.length);for(let r=0,n=m.length;r<n;r++)t[r]=m[r]*e;m=t}for(let e=0,t=B.length;e<t;e++){const t=new h(B[e]+"."+$[f.path],r.array,m,p);"CUBICSPLINE"===d.interpolation&&(t.createInterpolant=function(e){return new(this instanceof s.QuaternionKeyframeTrack?P:L)(this.times,this.values,this.getValueSize()/3,e)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(t)}}const c=t.name?t.name:"animation_"+e;return new s.AnimationClip(c,void 0,u)}))}createNodeMesh(e){const t=this.json,r=this,n=t.nodes[e];return void 0===n.mesh?null:r.getDependency("mesh",n.mesh).then((function(e){const t=r._getNodeRef(r.meshCache,n.mesh,e);return void 0!==n.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,r=n.weights.length;t<r;t++)e.morphTargetInfluences[t]=n.weights[t]})),t}))}loadNode(e){const t=this.json,r=this.extensions,n=this,a=t.nodes[e],o=a.name?n.createUniqueName(a.name):"";return function(){const t=[],r=n._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return r&&t.push(r),void 0!==a.camera&&t.push(n.getDependency("camera",a.camera).then((function(e){return n._getNodeRef(n.cameraCache,a.camera,e)}))),n._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){let i;if(i=!0===a.isBone?new s.Bone:t.length>1?new s.Group:1===t.length?t[0]:new s.Object3D,i!==t[0])for(let e=0,r=t.length;e<r;e++)i.add(t[e]);if(a.name&&(i.userData.name=a.name,i.name=o),oe(i,a),a.extensions&&ae(r,i,a),void 0!==a.matrix){const e=new s.Matrix4;e.fromArray(a.matrix),i.applyMatrix4(e)}else void 0!==a.translation&&i.position.fromArray(a.translation),void 0!==a.rotation&&i.quaternion.fromArray(a.rotation),void 0!==a.scale&&i.scale.fromArray(a.scale);return n.associations.has(i)||n.associations.set(i,{}),n.associations.get(i).nodes=e,i}))}loadScene(e){const t=this.json,r=this.extensions,n=this.json.scenes[e],a=this,o=new s.Group;n.name&&(o.name=a.createUniqueName(n.name)),oe(o,n),n.extensions&&ae(r,o,n);const i=n.nodes||[],l=[];for(let e=0,r=i.length;e<r;e++)l.push(de(i[e],o,t,a));return Promise.all(l).then((function(){return a.associations=(e=>{const t=new Map;for(const[e,r]of a.associations)(e instanceof s.Material||e instanceof s.Texture)&&t.set(e,r);return e.traverse((e=>{const r=a.associations.get(e);null!=r&&t.set(e,r)})),t})(o),o}))}}function de(e,t,r,n){const a=r.nodes[e];return n.getDependency("node",e).then((function(e){if(void 0===a.skin)return e;let t;return n.getDependency("skin",a.skin).then((function(e){t=e;const r=[];for(let e=0,a=t.joints.length;e<a;e++)r.push(n.getDependency("node",t.joints[e]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(!e.isMesh)return;const n=[],a=[];for(let e=0,o=r.length;e<o;e++){const o=r[e];if(o){n.push(o);const r=new s.Matrix4;void 0!==t.inverseBindMatrices&&r.fromArray(t.inverseBindMatrices.array,16*e),a.push(r)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[e])}e.bind(new s.Skeleton(n,a),e.matrixWorld)})),e}))})).then((function(e){t.add(e);const o=[];if(a.children){const t=a.children;for(let a=0,i=t.length;a<i;a++){const i=t[a];o.push(de(i,e,r,n))}}return Promise.all(o)}))}function fe(e,t,r){const n=t.attributes,a=[];function o(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(const t in n){const r=q[t]||t.toLowerCase();r in e.attributes||a.push(o(n[t],r))}if(void 0!==t.indices&&!e.index){const n=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));a.push(n)}return oe(e,t),function(e,t,r){const n=t.attributes,a=new s.Box3;if(void 0===n.POSITION)return;{const e=r.json.accessors[n.POSITION],t=e.min,o=e.max;if(void 0===t||void 0===o)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(a.set(new s.Vector3(t[0],t[1],t[2]),new s.Vector3(o[0],o[1],o[2])),e.normalized){const t=ue(Y[e.componentType]);a.min.multiplyScalar(t),a.max.multiplyScalar(t)}}const o=t.targets;if(void 0!==o){const e=new s.Vector3,t=new s.Vector3;for(let n=0,a=o.length;n<a;n++){const a=o[n];if(void 0!==a.POSITION){const n=r.json.accessors[a.POSITION],o=n.min,i=n.max;if(void 0!==o&&void 0!==i){if(t.setX(Math.max(Math.abs(o[0]),Math.abs(i[0]))),t.setY(Math.max(Math.abs(o[1]),Math.abs(i[1]))),t.setZ(Math.max(Math.abs(o[2]),Math.abs(i[2]))),n.normalized){const e=ue(Y[n.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}a.expandByVector(e)}e.boundingBox=a;const i=new s.Sphere;a.getCenter(i.center),i.radius=a.min.distanceTo(a.max)/2,e.boundingSphere=i}(e,t,r),Promise.all(a).then((function(){return void 0!==t.targets?function(e,t,r){let n=!1,a=!1,o=!1;for(let e=0,r=t.length;e<r;e++){const r=t[e];if(void 0!==r.POSITION&&(n=!0),void 0!==r.NORMAL&&(a=!0),void 0!==r.COLOR_0&&(o=!0),n&&a&&o)break}if(!n&&!a&&!o)return Promise.resolve(e);const i=[],s=[],l=[];for(let u=0,c=t.length;u<c;u++){const c=t[u];if(n){const t=void 0!==c.POSITION?r.getDependency("accessor",c.POSITION):e.attributes.position;i.push(t)}if(a){const t=void 0!==c.NORMAL?r.getDependency("accessor",c.NORMAL):e.attributes.normal;s.push(t)}if(o){const t=void 0!==c.COLOR_0?r.getDependency("accessor",c.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(i),Promise.all(s),Promise.all(l)]).then((function(t){const r=t[0],i=t[1],s=t[2];return n&&(e.morphAttributes.position=r),a&&(e.morphAttributes.normal=i),o&&(e.morphAttributes.color=s),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}function he(e,t){let r=e.getIndex();if(null===r){const t=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}const n=r.count-2,a=[];if(t===s.TriangleFanDrawMode)for(let e=1;e<=n;e++)a.push(r.getX(0)),a.push(r.getX(e)),a.push(r.getX(e+1));else for(let e=0;e<n;e++)e%2==0?(a.push(r.getX(e)),a.push(r.getX(e+1)),a.push(r.getX(e+2))):(a.push(r.getX(e+2)),a.push(r.getX(e+1)),a.push(r.getX(e)));a.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=e.clone();return o.setIndex(a),o}var Ae=r(1179);let pe=null;function Be(e,t,r){return n=>{r&&r(n),e&&(pe||(pe=new u),pe.setDecoderPath("string"==typeof e?e:"https://www.gstatic.com/draco/versioned/decoders/1.4.3/"),n.setDRACOLoader(pe)),t&&n.setMeshoptDecoder(f())}}function me(e,t=!0,r=!0,n){return(0,Ae.D)(h,e,Be(t,r,n))}me.preload=(e,t=!0,r=!0,n)=>Ae.D.preload(h,e,Be(t,r,n)),me.clear=e=>Ae.D.clear(h,e);const ge=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function ve(e,t){const r=(0,Ae.z)((e=>e.gl)),n=(0,Ae.D)(s.TextureLoader,ge(e)?Object.values(e):e);if((0,i.useLayoutEffect)((()=>{null==t||t(n)}),[t]),(0,i.useEffect)((()=>{(Array.isArray(n)?n:[n]).forEach(r.initTexture)}),[r,n]),ge(e)){const t=Object.keys(e),r={};return t.forEach((e=>Object.assign(r,{[e]:n[t.indexOf(e)]}))),r}return n}ve.preload=e=>Ae.D.preload(s.TextureLoader,e),ve.clear=e=>Ae.D.clear(s.TextureLoader,e);var Ce=function(){return Ce=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Ce.apply(this,arguments)},ye=function(e){var t=e.node,r=e.texture,a=e.tasselsTexture,o=e.tassels,l=e.hex,u=(0,i.useState)(),c=u[0],d=u[1],f=(0,i.useRef)(null),h=(0,i.useRef)(null),A=(0,i.useMemo)((function(){return Object.fromEntries(Object.entries(r).map((function(e){return[e[0],e[1].clone()]})))}),[r]);return(0,i.useEffect)((function(){var e;if(A&&h.current){for(var t={},r=0,n=Object.entries(A);r<n.length;r++){var a=n[r],o=a[0],i=a[1];i.wrapS=i.wrapT=s.RepeatWrapping;var l=(new s.Box3).setFromObject(h.current),u=new s.Vector3,c=l.getSize(u),f=c.x*c.y;i.repeat.set(5e-4*f,5e-4*f),t=Ce(Ce({},t),((e={})[o]=i,e))}d(t)}}),[A]),f.current&&(f.current.needsUpdate=!0),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("mesh",Ce({geometry:t.geometry,ref:h},{children:o?(0,n.jsx)("meshStandardMaterial",Ce({ref:f},a,{transparent:!0,bumpScale:.15,color:l,side:s.DoubleSide,metalness:-.5})):(0,n.jsx)("meshStandardMaterial",Ce({side:s.DoubleSide},c,{displacementScale:(null==c?void 0:c.displacementMap)?0:void 0,ref:f}))}))})},be=function(e){var t=e.node,r=e.nodeId,o=(0,a.b)((0,i.useCallback)((function(e){return e.texture(r)}),[r])),l=(0,a.b)((0,i.useCallback)((function(e){return e.optional(r)}),[r])),u=(0,a.b)((0,i.useCallback)((function(e){return e.tassels(r)}),[r])),c=ve(Ce({},o.materials)),d=ve({alphaMap:"https://boxxer-api-dev.nyc3.cdn.digitaloceanspaces.com/tassels/tassels-opacity.jpg",bumpMap:"https://boxxer-api-dev.nyc3.cdn.digitaloceanspaces.com/tassels/tassels-bump.jpg"},(function(e){var t=e,r=t[0],n=t[1];n.wrapS=n.wrapT=s.RepeatWrapping,n.flipY=!1,n.repeat.set(1.5,1),n.needsUpdate=!0,r.wrapS=r.wrapT=s.RepeatWrapping,r.flipY=!1,r.repeat.set(1.5,1),r.needsUpdate=!0}));return l?null:(0,n.jsx)(ye,{node:t,texture:c,tasselsTexture:d,tassels:u,hex:o.hex})},Fe=function(e){var t,r,a,o,s,l,u=e.model,c=e.addNodes,d=me(null===(o=null===(a=null===(r=null===(t=null==u?void 0:u.attributes)||void 0===t?void 0:t.model)||void 0===r?void 0:r.data)||void 0===a?void 0:a.attributes)||void 0===o?void 0:o.url).nodes;return(0,i.useEffect)((function(){return delete d.Scene,c(d),function(){c(d,!0)}}),[d]),(0,n.jsx)(n.Fragment,{children:null===(l=null===(s=null==u?void 0:u.attributes)||void 0===s?void 0:s.parts)||void 0===l?void 0:l.data.map((function(e){var t;return(0,n.jsx)(i.Fragment,{children:(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t.nodeId)&&(0,n.jsx)(be,{node:d[e.attributes.nodeId],nodeId:e.attributes.nodeId},e.attributes.nodeId)},e.id)}))})},Me=r(7462);class Ge extends s.BufferGeometry{constructor(e,t,r,n){super();const a=[],o=[],i=[],l=new s.Vector3,u=new s.Matrix4;u.makeRotationFromEuler(r),u.setPosition(t);const c=new s.Matrix4;function d(t,r,n){r.applyMatrix4(e.matrixWorld),r.applyMatrix4(c),n.transformDirection(e.matrixWorld),t.push(new Ee(r.clone(),n.clone()))}function f(e,t){const r=[],a=.5*Math.abs(n.dot(t));for(let n=0;n<e.length;n+=3){let o,i,s,l,u,c,d,f=0;const A=e[n+0].position.dot(t)-a,p=e[n+1].position.dot(t)-a,B=e[n+2].position.dot(t)-a;switch(o=A>0,i=p>0,s=B>0,f=(o?1:0)+(i?1:0)+(s?1:0),f){case 0:r.push(e[n]),r.push(e[n+1]),r.push(e[n+2]);break;case 1:if(o&&(l=e[n+1],u=e[n+2],c=h(e[n],l,t,a),d=h(e[n],u,t,a)),i){l=e[n],u=e[n+2],c=h(e[n+1],l,t,a),d=h(e[n+1],u,t,a),r.push(c),r.push(u.clone()),r.push(l.clone()),r.push(u.clone()),r.push(c.clone()),r.push(d);break}s&&(l=e[n],u=e[n+1],c=h(e[n+2],l,t,a),d=h(e[n+2],u,t,a)),r.push(l.clone()),r.push(u.clone()),r.push(c),r.push(d),r.push(c.clone()),r.push(u.clone());break;case 2:o||(l=e[n].clone(),u=h(l,e[n+1],t,a),c=h(l,e[n+2],t,a),r.push(l),r.push(u),r.push(c)),i||(l=e[n+1].clone(),u=h(l,e[n+2],t,a),c=h(l,e[n],t,a),r.push(l),r.push(u),r.push(c)),s||(l=e[n+2].clone(),u=h(l,e[n],t,a),c=h(l,e[n+1],t,a),r.push(l),r.push(u),r.push(c))}}return r}function h(e,t,r,n){const a=e.position.dot(r)-n,o=a/(a-(t.position.dot(r)-n));return new Ee(new s.Vector3(e.position.x+o*(t.position.x-e.position.x),e.position.y+o*(t.position.y-e.position.y),e.position.z+o*(t.position.z-e.position.z)),new s.Vector3(e.normal.x+o*(t.normal.x-e.normal.x),e.normal.y+o*(t.normal.y-e.normal.y),e.normal.z+o*(t.normal.z-e.normal.z)))}c.copy(u).invert(),function(){let t,r=[];const c=new s.Vector3,h=new s.Vector3;if(!0===e.geometry.isGeometry)return void console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");const A=e.geometry,p=A.attributes.position,B=A.attributes.normal;if(null!==A.index){const e=A.index;for(t=0;t<e.count;t++)c.fromBufferAttribute(p,e.getX(t)),h.fromBufferAttribute(B,e.getX(t)),d(r,c,h)}else for(t=0;t<p.count;t++)c.fromBufferAttribute(p,t),h.fromBufferAttribute(B,t),d(r,c,h);for(r=f(r,l.set(1,0,0)),r=f(r,l.set(-1,0,0)),r=f(r,l.set(0,1,0)),r=f(r,l.set(0,-1,0)),r=f(r,l.set(0,0,1)),r=f(r,l.set(0,0,-1)),t=0;t<r.length;t++){const e=r[t];i.push(.5+e.position.x/n.x,.5+e.position.y/n.y),e.position.applyMatrix4(u),a.push(e.position.x,e.position.y,e.position.z),o.push(e.normal.x,e.normal.y,e.normal.z)}}(),this.setAttribute("position",new s.Float32BufferAttribute(a,3)),this.setAttribute("normal",new s.Float32BufferAttribute(o,3)),this.setAttribute("uv",new s.Float32BufferAttribute(i,2))}}class Ee{constructor(e,t){this.position=e,this.normal=t}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}function xe(e=[0,0,0]){return function(e){return Array.isArray(e)}(e)?e:e instanceof s.Vector3||e instanceof s.Euler?[e.x,e.y,e.z]:[e,e,e]}function Te({debug:e,mesh:t,children:r,position:n,rotation:a,scale:o,...l}){const u=i.useRef(null),c=i.useRef(null);return i.useLayoutEffect((()=>{const e=(null==t?void 0:t.current)||u.current.parent,r=u.current;if(!(e instanceof s.Mesh))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');const i={position:new s.Vector3,rotation:new s.Euler,scale:new s.Vector3(1,1,1)};if(e){(0,Ae.j)(i,{position:n,scale:o});const t=e.matrixWorld.clone();if(e.matrixWorld.identity(),a&&"number"!=typeof a)(0,Ae.j)(i,{rotation:a});else{const t=new s.Object3D;t.position.copy(i.position),t.lookAt(e.position),"number"==typeof a&&t.rotateZ(a),(0,Ae.j)(i,{rotation:t.rotation})}return r.geometry=new Ge(e,i.position,i.rotation,i.scale),c.current&&(0,Ae.j)(c.current,i),e.matrixWorld=t,()=>{r.geometry.dispose()}}}),[t,...xe(n),...xe(o),...xe(a)]),i.createElement("mesh",{ref:u},r||i.createElement("meshStandardMaterial",(0,Me.Z)({transparent:!0,polygonOffset:!0,polygonOffsetFactor:-10},l)),e&&i.createElement("mesh",{ref:c},i.createElement("boxGeometry",null),i.createElement("meshNormalMaterial",{wireframe:!0}),i.createElement("axesHelper",null)))}var Se=function(){return Se=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Se.apply(this,arguments)},De=function(e){var t,r,a,o,l,u,c,d,f,h=e.flag,A=e.graphic,p=e.position,B=e.orientation,m=e.scale,g=void 0===m?1:m,v=ve((null===(o=null===(a=null===(r=null===(t=null==h?void 0:h.flag)||void 0===t?void 0:t.attributes)||void 0===r?void 0:r.image.data)||void 0===a?void 0:a.attributes)||void 0===o?void 0:o.url)?[h.flag.attributes.image.data.attributes.url]:(null===(f=null===(d=null===(c=null===(u=null===(l=null==A?void 0:A.graphic)||void 0===l?void 0:l.attributes)||void 0===u?void 0:u.image)||void 0===c?void 0:c.data)||void 0===d?void 0:d.attributes)||void 0===f?void 0:f.url)?[A.graphic.attributes.image.data.attributes.url]:[])[0],C=(0,i.useMemo)((function(){var e,t;return(null!==(e=v.source.data.width)&&void 0!==e?e:1)/(null!==(t=v.source.data.height)&&void 0!==t?t:1)}),[v]),y=(0,i.useMemo)((function(){var e=(new s.Euler).fromArray(B),t=s.MathUtils.radToDeg(e.z),r=(null==h?void 0:h.decalRotation)||(null==A?void 0:A.decalRotation),n=t+(null!=r?r:0);return e.z=s.MathUtils.degToRad(n),e}),[null==h?void 0:h.decalRotation,null==A?void 0:A.decalRotation,B]),b=(0,i.useMemo)((function(){return new s.Vector3(1*C*g,1*g,4)}),[g]);return v?(0,n.jsx)(Te,Se({position:p,rotation:y,scale:b},{children:(0,n.jsx)("meshPhongMaterial",{map:v,transparent:!0,depthTest:!0,depthWrite:!1,polygonOffset:!0,polygonOffsetFactor:-20,needsUpdate:!0})})):null};function Re(e,t,r){const{gl:n,size:a,viewport:o}=(0,Ae.z)(),l="number"==typeof e?e:a.width*o.dpr,u="number"==typeof t?t:a.height*o.dpr,c=("number"==typeof e?r:e)||{},{samples:d=0,depth:f,...h}=c,A=i.useMemo((()=>{let e;return e=new s.WebGLRenderTarget(l,u,{minFilter:s.LinearFilter,magFilter:s.LinearFilter,encoding:n.outputEncoding,type:s.HalfFloatType,...h}),f&&(e.depthTexture=new s.DepthTexture(l,u,s.FloatType)),e.samples=d,e}),[]);return i.useLayoutEffect((()=>{A.setSize(l,u),d&&(A.samples=d)}),[d,A,l,u]),i.useEffect((()=>()=>A.dispose()),[]),A}const Ie=i.forwardRef((({children:e,compute:t,width:r,height:n,samples:a=8,renderPriority:o=0,eventPriority:l=0,frames:u=1/0,stencilBuffer:c=!1,depthBuffer:d=!0,generateMipmaps:f=!1,...h},A)=>{const{size:p,viewport:B}=(0,Ae.z)(),m=Re((r||p.width)*B.dpr,(n||p.height)*B.dpr,{samples:a,stencilBuffer:c,depthBuffer:d,generateMipmaps:f}),[g]=i.useState((()=>new s.Scene)),v=i.useCallback(((e,t,r)=>{var n,a;let o=null==(n=m.texture)?void 0:n.__r3f.parent;for(;o&&!(o instanceof s.Object3D);)o=o.__r3f.parent;if(!o)return!1;r.raycaster.camera||r.events.compute(e,r,null==(a=r.previousRoot)?void 0:a.getState());const[i]=r.raycaster.intersectObject(o);if(!i)return!1;const l=i.uv;if(!l)return!1;t.raycaster.setFromCamera(t.pointer.set(2*l.x-1,2*l.y-1),t.camera)}),[]);return i.useImperativeHandle(A,(()=>m.texture),[m]),i.createElement(i.Fragment,null,(0,Ae.g)(i.createElement(Ue,{renderPriority:o,frames:u,fbo:m},e),g,{events:{compute:t||v,priority:l}}),i.createElement("primitive",(0,Me.Z)({object:m.texture},h)))}));function Ue({frames:e,renderPriority:t,children:r,fbo:n}){let a=0;return(0,Ae.A)((t=>{(e===1/0||a<e)&&(t.gl.setRenderTarget(n),t.gl.render(t.scene,t.camera),t.gl.setRenderTarget(null),a++)}),t),i.createElement(i.Fragment,null,r)}var we=function(e){return function(t){e.forEach((function(e){"function"==typeof e?e(t):null!=e&&(e.current=t)}))}};const He=i.forwardRef((({envMap:e,resolution:t=256,frames:r=1/0,makeDefault:n,children:a,...o},s)=>{const l=(0,Ae.z)((({set:e})=>e)),u=(0,Ae.z)((({camera:e})=>e)),c=(0,Ae.z)((({size:e})=>e)),d=i.useRef(null),f=i.useRef(null),h=Re(t);i.useLayoutEffect((()=>{o.manual||(d.current.aspect=c.width/c.height)}),[c,o]),i.useLayoutEffect((()=>{d.current.updateProjectionMatrix()}));let A=0,p=null;const B="function"==typeof a;return(0,Ae.A)((t=>{B&&(r===1/0||A<r)&&(f.current.visible=!1,t.gl.setRenderTarget(h),p=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,d.current),t.scene.background=p,t.gl.setRenderTarget(null),f.current.visible=!0,A++)})),i.useLayoutEffect((()=>{if(n){const e=u;return l((()=>({camera:d.current}))),()=>l((()=>({camera:e})))}}),[d,n,l]),i.createElement(i.Fragment,null,i.createElement("perspectiveCamera",(0,Me.Z)({ref:we([d,s])},o),!B&&a),i.createElement("group",{ref:f},B&&a(h.texture)))}));r(4155);function ke(){var e=Object.create(null);function t(n,a){var o=n.id,i=n.name,s=n.dependencies;void 0===s&&(s=[]);var l=n.init;void 0===l&&(l=function(){});var u=n.getTransferables;if(void 0===u&&(u=null),!e[o])try{s=s.map((function(r){return r&&r.isWorkerModule&&(t(r,(function(e){if(e instanceof Error)throw e})),r=e[r.id].value),r})),l=r("<"+i+">.init",l),u&&(u=r("<"+i+">.getTransferables",u));var c=null;"function"==typeof l?c=l.apply(void 0,s):console.error("worker module init function failed to rehydrate"),e[o]={id:o,value:c,getTransferables:u},a(c)}catch(e){e&&e.noLog||console.error(e),a(e)}}function r(e,t){var r=void 0;self.troikaDefine=function(e){return r=e};var n=URL.createObjectURL(new Blob(["/** "+e.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+t+"\n)"],{type:"application/javascript"}));try{importScripts(n)}catch(e){console.error(e)}return URL.revokeObjectURL(n),delete self.troikaDefine,r}self.addEventListener("message",(function(r){var n=r.data,a=n.messageId,o=n.action,i=n.data;try{"registerModule"===o&&t(i,(function(e){e instanceof Error?postMessage({messageId:a,success:!1,error:e.message}):postMessage({messageId:a,success:!0,result:{isCallable:"function"==typeof e}})})),"callModule"===o&&function(t,r){var n,a=t.id,o=t.args;e[a]&&"function"==typeof e[a].value||r(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var i=(n=e[a]).value.apply(n,o);i&&"function"==typeof i.then?i.then(s,(function(e){return r(e instanceof Error?e:new Error(""+e))})):s(i)}catch(e){r(e)}function s(t){try{var n=e[a].getTransferables&&e[a].getTransferables(t);n&&Array.isArray(n)&&n.length||(n=void 0),r(t,n)}catch(e){console.error(e),r(e)}}}(i,(function(e,t){e instanceof Error?postMessage({messageId:a,success:!1,error:e.message}):postMessage({messageId:a,success:!0,result:e},t||void 0)}))}catch(e){postMessage({messageId:a,success:!1,error:e.stack})}}))}var _e=function(){var e=!1;if("undefined"!=typeof window&&void 0!==window.document)try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),e=!0}catch(e){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+e.message+"]")}return _e=function(){return e},e},Le=0,Oe=0,Pe=!1,Je=Object.create(null),Ke=Object.create(null),Ne=Object.create(null);function je(e){if(!(e&&"function"==typeof e.init||Pe))throw new Error("requires `options.init` function");var t=e.dependencies,r=e.init,n=e.getTransferables,a=e.workerId;if(!_e())return function(e){var t=function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return t._getInitResult().then((function(t){if("function"==typeof t)return t.apply(void 0,e);throw new Error("Worker module function was called but `init` did not return a callable function")}))};return t._getInitResult=function(){var r=e.dependencies,n=e.init;r=Array.isArray(r)?r.map((function(e){return e&&e._getInitResult?e._getInitResult():e})):[];var a=Promise.all(r).then((function(e){return n.apply(null,e)}));return t._getInitResult=function(){return a},a},t}(e);null==a&&(a="#default");var o="workerModule"+ ++Le,i=e.name||o,s=null;function l(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(!s){s=Xe(a,"registerModule",l.workerModuleData);var r=function(){s=null,Ke[a].delete(r)};(Ke[a]||(Ke[a]=new Set)).add(r)}return s.then((function(t){if(t.isCallable)return Xe(a,"callModule",{id:o,args:e});throw new Error("Worker module function was called but `init` did not return a callable function")}))}return t=t&&t.map((function(e){return"function"!=typeof e||e.workerModuleData||(Pe=!0,e=je({workerId:a,name:"<"+i+"> function dependency: "+e.name,init:"function(){return (\n"+Qe(e)+"\n)}"}),Pe=!1),e&&e.workerModuleData&&(e=e.workerModuleData),e})),l.workerModuleData={isWorkerModule:!0,id:o,name:i,dependencies:t,init:Qe(r),getTransferables:n&&Qe(n)},l}function Qe(e){var t=e.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function Xe(e,t,r){return new Promise((function(n,a){var o=++Oe;Ne[o]=function(e){e.success?n(e.result):a(new Error("Error in worker "+t+" call: "+e.error))},function(e){var t=Je[e];if(!t){var r=Qe(ke);(t=Je[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+" **/\n\n;("+r+")()"],{type:"application/javascript"})))).onmessage=function(e){var t=e.data,r=t.messageId,n=Ne[r];if(!n)throw new Error("WorkerModule response with empty or unknown messageId");delete Ne[r],n(t)}}return t}(e).postMessage({messageId:o,action:t,data:r})}))}function We(){var e=function(e){function t(e,t,r,n,a,o,i,s,l,u){var c=1-l;u.x=c*c*c*e+3*c*c*l*r+3*c*l*l*a+l*l*l*i,u.y=c*c*c*t+3*c*c*l*n+3*c*l*l*o+l*l*l*s}function r(e,t){for(var r,n,a,o,i,s=/([MLQCZ])([^MLQCZ]*)/g;r=s.exec(e);){var l=r[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map((function(e){return parseFloat(e)}));switch(r[1]){case"M":o=n=l[0],i=a=l[1];break;case"L":l[0]===o&&l[1]===i||t("L",o,i,o=l[0],i=l[1]);break;case"Q":t("Q",o,i,o=l[2],i=l[3],l[0],l[1]);break;case"C":t("C",o,i,o=l[4],i=l[5],l[0],l[1],l[2],l[3]);break;case"Z":o===n&&i===a||t("L",o,i,n,a)}}}function n(e,n,a){void 0===a&&(a=16);var o={x:0,y:0};r(e,(function(e,r,i,s,l,u,c,d,f){switch(e){case"L":n(r,i,s,l);break;case"Q":for(var h=r,A=i,p=1;p<a;p++)v=i,C=c,y=l,M=void 0,M=1-(b=p/(a-1)),(F=o).x=M*M*r+2*M*b*u+b*b*s,F.y=M*M*v+2*M*b*C+b*b*y,n(h,A,o.x,o.y),h=o.x,A=o.y;break;case"C":for(var B=r,m=i,g=1;g<a;g++)t(r,i,u,c,d,f,s,l,g/(a-1),o),n(B,m,o.x,o.y),B=o.x,m=o.y}var v,C,y,b,F,M}))}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o=new WeakMap,i={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(e,t){var r=e.getContext?e.getContext("webgl",i):e,n=o.get(r);if(!n){var a="undefined"!=typeof WebGL2RenderingContext&&r instanceof WebGL2RenderingContext,s={},l={},u={},c=-1,d=[];function f(e){var t=s[e];if(!t&&!(t=s[e]=r.getExtension(e)))throw new Error(e+" not supported");return t}function h(e,t){var n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),n}function A(e,t,n,o){if(!l[e]){var i={},s={},u=r.createProgram();r.attachShader(u,h(t,r.VERTEX_SHADER)),r.attachShader(u,h(n,r.FRAGMENT_SHADER)),r.linkProgram(u),l[e]={program:u,transaction:function(e){r.useProgram(u),e({setUniform:function(e,t){for(var n=[],a=arguments.length-2;a-- >0;)n[a]=arguments[a+2];var o=s[t]||(s[t]=r.getUniformLocation(u,t));r["uniform"+e].apply(r,[o].concat(n))},setAttribute:function(e,t,n,o,s){var l=i[e];l||(l=i[e]={buf:r.createBuffer(),loc:r.getAttribLocation(u,e),data:null}),r.bindBuffer(r.ARRAY_BUFFER,l.buf),r.vertexAttribPointer(l.loc,t,r.FLOAT,!1,0,0),r.enableVertexAttribArray(l.loc),a?r.vertexAttribDivisor(l.loc,o):f("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(l.loc,o),s!==l.data&&(r.bufferData(r.ARRAY_BUFFER,s,n),l.data=s)}})}}}l[e].transaction(o)}function p(e,t){c++;try{r.activeTexture(r.TEXTURE0+c);var n=u[e];n||(n=u[e]=r.createTexture(),r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST)),r.bindTexture(r.TEXTURE_2D,n),t(n,c)}finally{c--}}function B(e,t,n){var a=r.createFramebuffer();d.push(a),r.bindFramebuffer(r.FRAMEBUFFER,a),r.activeTexture(r.TEXTURE0+t),r.bindTexture(r.TEXTURE_2D,e),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);try{n(a)}finally{r.deleteFramebuffer(a),r.bindFramebuffer(r.FRAMEBUFFER,d[--d.length-1]||null)}}function m(){s={},l={},u={},c=-1,d.length=0}r.canvas.addEventListener("webglcontextlost",(function(e){m(),e.preventDefault()}),!1),o.set(r,n={gl:r,isWebGL2:a,getExtension:f,withProgram:A,withTexture:p,withTextureFramebuffer:B,handleContextLoss:m})}t(n)}function l(e,t,r,n,o,i,l,u){void 0===l&&(l=15),void 0===u&&(u=null),s(e,(function(e){var s=e.gl,c=e.withProgram;(0,e.withTexture)("copy",(function(e,d){s.texImage2D(s.TEXTURE_2D,0,s.RGBA,o,i,0,s.RGBA,s.UNSIGNED_BYTE,t),c("copy",a,"precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",(function(e){var t=e.setUniform;(0,e.setAttribute)("aUV",2,s.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),t("1i","image",d),s.bindFramebuffer(s.FRAMEBUFFER,u||null),s.disable(s.BLEND),s.colorMask(8&l,4&l,2&l,1&l),s.viewport(r,n,o,i),s.scissor(r,n,o,i),s.drawArrays(s.TRIANGLES,0,3)}))}))}))}var u=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:l,resizeWebGLCanvasWithoutClearing:function(e,t,r){var n=e.width,a=e.height;s(e,(function(o){var i=o.gl,s=new Uint8Array(n*a*4);i.readPixels(0,0,n,a,i.RGBA,i.UNSIGNED_BYTE,s),e.width=t,e.height=r,l(i,s,0,0,n,a)}))}});function c(e,t,r,a,o,i){void 0===i&&(i=1);var s=new Uint8Array(e*t),l=a[2]-a[0],u=a[3]-a[1],c=[];n(r,(function(e,t,r,n){c.push({x1:e,y1:t,x2:r,y2:n,minX:Math.min(e,r),minY:Math.min(t,n),maxX:Math.max(e,r),maxY:Math.max(t,n)})})),c.sort((function(e,t){return e.maxX-t.maxX}));for(var d=0;d<e;d++)for(var f=0;f<t;f++){var A=B(a[0]+l*(d+.5)/e,a[1]+u*(f+.5)/t),p=Math.pow(1-Math.abs(A)/o,i)/2;A<0&&(p=1-p),p=Math.max(0,Math.min(255,Math.round(255*p))),s[f*e+d]=p}return s;function B(e,t){for(var r=1/0,n=1/0,a=c.length;a--;){var o=c[a];if(o.maxX+n<=e)break;if(e+n>o.minX&&t-n<o.maxY&&t+n>o.minY){var i=h(e,t,o.x1,o.y1,o.x2,o.y2);i<r&&(r=i,n=Math.sqrt(r))}}return function(e,t){for(var r=0,n=c.length;n--;){var a=c[n];if(a.maxX<=e)break;a.y1>t!=a.y2>t&&e<(a.x2-a.x1)*(t-a.y1)/(a.y2-a.y1)+a.x1&&(r+=a.y1<a.y2?1:-1)}return 0!==r}(e,t)&&(n=-n),n}}function d(e,t,r,n,a,o,i,s,l,u){void 0===o&&(o=1),void 0===s&&(s=0),void 0===l&&(l=0),void 0===u&&(u=0),f(e,t,r,n,a,o,i,null,s,l,u)}function f(e,t,r,n,a,o,i,s,u,d,f){void 0===o&&(o=1),void 0===u&&(u=0),void 0===d&&(d=0),void 0===f&&(f=0);for(var h=c(e,t,r,n,a,o),A=new Uint8Array(4*h.length),p=0;p<h.length;p++)A[4*p+f]=h[p];l(i,A,u,d,e,t,1<<3-f,s)}function h(e,t,r,n,a,o){var i=a-r,s=o-n,l=i*i+s*s,u=l?Math.max(0,Math.min(1,((e-r)*i+(t-n)*s)/l)):0,c=e-(r+u*i),d=t-(n+u*s);return c*c+d*d}var A=Object.freeze({__proto__:null,generate:c,generateIntoCanvas:d,generateIntoFramebuffer:f}),p=new Float32Array([0,0,2,0,0,2]),B=null,m=!1,g={},v=new WeakMap;function C(e){if(!m&&!M(e))throw new Error("WebGL generation not supported")}function y(e,t,r,n,a,o,i){if(void 0===o&&(o=1),void 0===i&&(i=null),!i&&!(i=B)){var l="function"==typeof OffscreenCanvas?new OffscreenCanvas(1,1):"undefined"!=typeof document?document.createElement("canvas"):null;if(!l)throw new Error("OffscreenCanvas or DOM canvas not supported");i=B=l.getContext("webgl",{depth:!1})}C(i);var u=new Uint8Array(e*t*4);s(i,(function(i){var s=i.gl,l=i.withTexture,c=i.withTextureFramebuffer;l("readable",(function(i,l){s.texImage2D(s.TEXTURE_2D,0,s.RGBA,e,t,0,s.RGBA,s.UNSIGNED_BYTE,null),c(i,l,(function(i){F(e,t,r,n,a,o,s,i,0,0,0),s.readPixels(0,0,e,t,s.RGBA,s.UNSIGNED_BYTE,u)}))}))}));for(var c=new Uint8Array(e*t),d=0,f=0;d<u.length;d+=4)c[f++]=u[d];return c}function b(e,t,r,n,a,o,i,s,l,u){void 0===o&&(o=1),void 0===s&&(s=0),void 0===l&&(l=0),void 0===u&&(u=0),F(e,t,r,n,a,o,i,null,s,l,u)}function F(e,t,r,o,i,l,u,c,d,f,h){void 0===l&&(l=1),void 0===d&&(d=0),void 0===f&&(f=0),void 0===h&&(h=0),C(u);var A=[];n(r,(function(e,t,r,n){A.push(e,t,r,n)})),A=new Float32Array(A),s(u,(function(r){var n=r.gl,s=r.isWebGL2,u=r.getExtension,B=r.withProgram,m=r.withTexture,g=r.withTextureFramebuffer,v=r.handleContextLoss;if(m("rawDistances",(function(r,m){e===r._lastWidth&&t===r._lastHeight||n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r._lastWidth=e,r._lastHeight=t,0,n.RGBA,n.UNSIGNED_BYTE,null),B("main","precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}","precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",(function(a){var c=a.setAttribute,d=a.setUniform,f=!s&&u("ANGLE_instanced_arrays"),h=!s&&u("EXT_blend_minmax");c("aUV",2,n.STATIC_DRAW,0,p),c("aLineSegment",4,n.DYNAMIC_DRAW,1,A),d.apply(void 0,["4f","uGlyphBounds"].concat(o)),d("1f","uMaxDistance",i),d("1f","uExponent",l),g(r,m,(function(r){n.enable(n.BLEND),n.colorMask(!0,!0,!0,!0),n.viewport(0,0,e,t),n.scissor(0,0,e,t),n.blendFunc(n.ONE,n.ONE),n.blendEquationSeparate(n.FUNC_ADD,s?n.MAX:h.MAX_EXT),n.clear(n.COLOR_BUFFER_BIT),s?n.drawArraysInstanced(n.TRIANGLES,0,3,A.length/4):f.drawArraysInstancedANGLE(n.TRIANGLES,0,3,A.length/4)}))})),B("post",a,"precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",(function(r){r.setAttribute("aUV",2,n.STATIC_DRAW,0,p),r.setUniform("1i","tex",m),n.bindFramebuffer(n.FRAMEBUFFER,c),n.disable(n.BLEND),n.colorMask(0===h,1===h,2===h,3===h),n.viewport(d,f,e,t),n.scissor(d,f,e,t),n.drawArrays(n.TRIANGLES,0,3)}))})),n.isContextLost())throw v(),new Error("webgl context lost")}))}function M(e){var t=e&&e!==B?e.canvas||e:g,r=v.get(t);if(void 0===r){m=!0;var n=null;try{var a=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],o=y(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,e);(r=o&&a.length===o.length&&o.every((function(e,t){return e===a[t]})))||(n="bad trial run results",console.info(a,o))}catch(e){r=!1,n=e.message}n&&console.warn("WebGL SDF generation not supported:",n),m=!1,v.set(t,r)}return r}var G=Object.freeze({__proto__:null,generate:y,generateIntoCanvas:b,generateIntoFramebuffer:F,isSupported:M});return e.forEachPathCommand=r,e.generate=function(e,t,r,n,a,o){void 0===a&&(a=Math.max(n[2]-n[0],n[3]-n[1])/2),void 0===o&&(o=1);try{return y.apply(G,arguments)}catch(e){return console.info("WebGL SDF generation failed, falling back to JS",e),c.apply(A,arguments)}},e.generateIntoCanvas=function(e,t,r,n,a,o,i,s,l,u){void 0===a&&(a=Math.max(n[2]-n[0],n[3]-n[1])/2),void 0===o&&(o=1),void 0===s&&(s=0),void 0===l&&(l=0),void 0===u&&(u=0);try{return b.apply(G,arguments)}catch(e){return console.info("WebGL SDF generation failed, falling back to JS",e),d.apply(A,arguments)}},e.javascript=A,e.pathToLineSegments=n,e.webgl=G,e.webglUtils=u,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return e}var Ye=function(){return function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},r={},n={};r.L=1,n[1]="L",Object.keys(t).forEach((function(e,t){r[e]=1<<t+1,n[r[e]]=e})),Object.freeze(r);var a=r.LRI|r.RLI|r.FSI,o=r.L|r.R|r.AL,i=r.B|r.S|r.WS|r.ON|r.FSI|r.LRI|r.RLI|r.PDI,s=r.BN|r.RLE|r.LRE|r.RLO|r.LRO|r.PDF,l=r.S|r.WS|r.B|a|r.PDI|s,u=null;function c(e){return function(){if(!u){u=new Map;var e=function(e){if(t.hasOwnProperty(e)){var n=0;t[e].split(",").forEach((function(t){var a=t.split("+"),o=a[0],i=a[1];o=parseInt(o,36),i=i?parseInt(i,36):0,u.set(n+=o,r[e]);for(var s=0;s<i;s++)u.set(++n,r[e])}))}};for(var n in t)e(n)}}(),u.get(e.codePointAt(0))||r.L}var d,f,h,A="14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",p="6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye";function B(e,t){var r,n=0,a=new Map,o=t&&new Map;return e.split(",").forEach((function e(i){if(-1!==i.indexOf("+"))for(var s=+i;s--;)e(r);else{r=i;var l=i.split(">"),u=l[0],c=l[1];u=String.fromCodePoint(n+=parseInt(u,36)),c=String.fromCodePoint(n+=parseInt(c,36)),a.set(u,c),t&&o.set(c,u)}})),{map:a,reverseMap:o}}function m(){if(!d){var e=B(A,!0),t=e.map,r=e.reverseMap;d=t,f=r,h=B(p,!1).map}}function g(e){return m(),d.get(e)||null}function v(e){return m(),f.get(e)||null}function C(e){return m(),h.get(e)||null}var y=r.L,b=r.R,F=r.EN,M=r.ES,G=r.ET,E=r.AN,x=r.CS,T=r.B,S=r.S,D=r.ON,R=r.BN,I=r.NSM,U=r.AL,w=r.LRO,H=r.RLO,k=r.LRE,_=r.RLE,L=r.PDF,O=r.LRI,P=r.RLI,J=r.FSI,K=r.PDI;var N;function j(e){return function(){if(!N){var e=B("14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",!0),t=e.map;e.reverseMap.forEach((function(e,r){t.set(r,e)})),N=t}}(),N.get(e)||null}function Q(e,t,r,n){var a=e.length;r=Math.max(0,null==r?0:+r),n=Math.min(a-1,null==n?a-1:+n);var o=[];return t.paragraphs.forEach((function(a){var i=Math.max(r,a.start),s=Math.min(n,a.end);if(i<s){for(var u=t.levels.slice(i,s+1),d=s;d>=i&&c(e[d])&l;d--)u[d]=a.level;for(var f=a.level,h=1/0,A=0;A<u.length;A++){var p=u[A];p>f&&(f=p),p<h&&(h=1|p)}for(var B=f;B>=h;B--)for(var m=0;m<u.length;m++)if(u[m]>=B){for(var g=m;m+1<u.length&&u[m+1]>=B;)m++;m>g&&o.push([g+r,m+r])}}})),o}function X(e,t,r,n){for(var a=Q(e,t,r,n),o=[],i=0;i<e.length;i++)o[i]=i;return a.forEach((function(e){for(var t=e[0],r=e[1],n=o.slice(t,r+1),a=n.length;a--;)o[r-a]=n[a]})),o}return e.closingToOpeningBracket=v,e.getBidiCharType=c,e.getBidiCharTypeName=function(e){return n[c(e)]},e.getCanonicalBracket=C,e.getEmbeddingLevels=function(e,t){for(var r=new Uint32Array(e.length),n=0;n<e.length;n++)r[n]=c(e[n]);var u=new Map;function d(e,t){var n=r[e];r[e]=t,u.set(n,u.get(n)-1),n&i&&u.set(i,u.get(i)-1),u.set(t,(u.get(t)||0)+1),t&i&&u.set(i,(u.get(i)||0)+1)}for(var f=new Uint8Array(e.length),h=new Map,A=[],p=null,B=0;B<e.length;B++)p||A.push(p={start:B,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:Jt(B,!1)}),r[B]&T&&(p.end=B,p=null);for(var m=_|k|H|w|a|K|L|T,N=function(e){return e+(1&e?1:2)},j=function(e){return e+(1&e?2:1)},Q=0;Q<A.length;Q++){var X=[{_level:(p=A[Q]).level,_override:0,_isolate:0}],W=void 0,Y=0,V=0,Z=0;u.clear();for(var z=p.start;z<=p.end;z++){var q=r[z];if(W=X[X.length-1],u.set(q,(u.get(q)||0)+1),q&i&&u.set(i,(u.get(i)||0)+1),q&m)if(q&(_|k)){f[z]=W._level;var $=(q===_?j:N)(W._level);$<=125&&!Y&&!V?X.push({_level:$,_override:0,_isolate:0}):Y||V++}else if(q&(H|w)){f[z]=W._level;var ee=(q===H?j:N)(W._level);ee<=125&&!Y&&!V?X.push({_level:ee,_override:q&H?b:y,_isolate:0}):Y||V++}else if(q&a){q&J&&(q=1===Jt(z+1,!0)?P:O),f[z]=W._level,W._override&&d(z,W._override);var te=(q===P?j:N)(W._level);te<=125&&0===Y&&0===V?(Z++,X.push({_level:te,_override:0,_isolate:1,_isolInitIndex:z})):Y++}else if(q&K){if(Y>0)Y--;else if(Z>0){for(V=0;!X[X.length-1]._isolate;)X.pop();var re=X[X.length-1]._isolInitIndex;null!=re&&(h.set(re,z),h.set(z,re)),X.pop(),Z--}W=X[X.length-1],f[z]=W._level,W._override&&d(z,W._override)}else q&L?(0===Y&&(V>0?V--:!W._isolate&&X.length>1&&(X.pop(),W=X[X.length-1])),f[z]=W._level):q&T&&(f[z]=p.level);else f[z]=W._level,W._override&&q!==R&&d(z,W._override)}for(var ne=[],ae=null,oe=p.start;oe<=p.end;oe++){var ie=r[oe];if(!(ie&s)){var se=f[oe],le=ie&a,ue=ie===K;ae&&se===ae._level?(ae._end=oe,ae._endsWithIsolInit=le):ne.push(ae={_start:oe,_end:oe,_level:se,_startsWithPDI:ue,_endsWithIsolInit:le})}}for(var ce=[],de=0;de<ne.length;de++){var fe=ne[de];if(!fe._startsWithPDI||fe._startsWithPDI&&!h.has(fe._start)){for(var he=[ae=fe],Ae=void 0;ae&&ae._endsWithIsolInit&&null!=(Ae=h.get(ae._end));)for(var pe=de+1;pe<ne.length;pe++)if(ne[pe]._start===Ae){he.push(ae=ne[pe]);break}for(var Be=[],me=0;me<he.length;me++)for(var ge=he[me],ve=ge._start;ve<=ge._end;ve++)Be.push(ve);for(var Ce=f[Be[0]],ye=p.level,be=Be[0]-1;be>=0;be--)if(!(r[be]&s)){ye=f[be];break}var Fe=Be[Be.length-1],Me=f[Fe],Ge=p.level;if(!(r[Fe]&a))for(var Ee=Fe+1;Ee<=p.end;Ee++)if(!(r[Ee]&s)){Ge=f[Ee];break}ce.push({_seqIndices:Be,_sosType:Math.max(ye,Ce)%2?b:y,_eosType:Math.max(Ge,Me)%2?b:y})}}for(var xe=0;xe<ce.length;xe++){var Te=ce[xe],Se=Te._seqIndices,De=Te._sosType,Re=Te._eosType;if(u.get(I))for(var Ie=0;Ie<Se.length;Ie++){var Ue=Se[Ie];if(r[Ue]&I){for(var we=De,He=Ie-1;He>=0;He--)if(!(r[Se[He]]&s)){we=r[Se[He]];break}d(Ue,we&(a|K)?D:we)}}if(u.get(F))for(var ke=0;ke<Se.length;ke++){var _e=Se[ke];if(r[_e]&F)for(var Le=ke-1;Le>=-1;Le--){var Oe=-1===Le?De:r[Se[Le]];if(Oe&o){Oe===U&&d(_e,E);break}}}if(u.get(U))for(var Pe=0;Pe<Se.length;Pe++){var Je=Se[Pe];r[Je]&U&&d(Je,b)}if(u.get(M)||u.get(x))for(var Ke=1;Ke<Se.length-1;Ke++){var Ne=Se[Ke];if(r[Ne]&(M|x)){for(var je=0,Qe=0,Xe=Ke-1;Xe>=0&&(je=r[Se[Xe]])&s;Xe--);for(var We=Ke+1;We<Se.length&&(Qe=r[Se[We]])&s;We++);je===Qe&&(r[Ne]===M?je===F:je&(F|E))&&d(Ne,je)}}if(u.get(F))for(var Ye=0;Ye<Se.length;Ye++){var Ve=Se[Ye];if(r[Ve]&F){for(var Ze=Ye-1;Ze>=0&&r[Se[Ze]]&(G|s);Ze--)d(Se[Ze],F);for(var ze=Ye+1;ze<Se.length&&r[Se[ze]]&(G|s);ze++)d(Se[ze],F)}}if(u.get(G)||u.get(M)||u.get(x))for(var qe=0;qe<Se.length;qe++){var $e=Se[qe];if(r[$e]&(G|M|x)){d($e,D);for(var et=qe-1;et>=0&&r[Se[et]]&s;et--)d(Se[et],D);for(var tt=qe+1;tt<Se.length&&r[Se[tt]]&s;tt++)d(Se[tt],D)}}if(u.get(F))for(var rt=0,nt=De;rt<Se.length;rt++){var at=Se[rt],ot=r[at];ot&F?nt===y&&d(at,y):ot&o&&(nt=ot)}if(u.get(i)){for(var it=b|F|E,st=it|y,lt=[],ut=[],ct=0;ct<Se.length;ct++)if(r[Se[ct]]&i){var dt=e[Se[ct]],ft=void 0;if(null!==g(dt)){if(!(ut.length<63))break;ut.push({char:dt,seqIndex:ct})}else if(null!==(ft=v(dt)))for(var ht=ut.length-1;ht>=0;ht--){var At=ut[ht].char;if(At===ft||At===v(C(dt))||g(C(At))===dt){lt.push([ut[ht].seqIndex,ct]),ut.length=ht;break}}}lt.sort((function(e,t){return e[0]-t[0]}));for(var pt=0;pt<lt.length;pt++){for(var Bt=lt[pt],mt=Bt[0],gt=Bt[1],vt=!1,Ct=0,yt=mt+1;yt<gt;yt++){var bt=Se[yt];if(r[bt]&st){vt=!0;var Ft=r[bt]&it?b:y;if(Ft===Nt(bt)){Ct=Ft;break}}}if(vt&&!Ct){Ct=De;for(var Mt=mt-1;Mt>=0;Mt--){var Gt=Se[Mt];if(r[Gt]&st){var Et=r[Gt]&it?b:y;Ct=Et!==Nt(Gt)?Et:Nt(Gt);break}}}if(Ct){if(r[Se[mt]]=r[Se[gt]]=Ct,Ct!==Nt(Se[mt]))for(var xt=mt+1;xt<Se.length;xt++)if(!(r[Se[xt]]&s)){c(e[Se[xt]])&I&&(r[Se[xt]]=Ct);break}if(Ct!==Nt(Se[gt]))for(var Tt=gt+1;Tt<Se.length;Tt++)if(!(r[Se[Tt]]&s)){c(e[Se[Tt]])&I&&(r[Se[Tt]]=Ct);break}}}for(var St=0;St<Se.length;St++)if(r[Se[St]]&i){for(var Dt=St,Rt=St,It=De,Ut=St-1;Ut>=0;Ut--){if(!(r[Se[Ut]]&s)){It=r[Se[Ut]]&it?b:y;break}Dt=Ut}for(var wt=Re,Ht=St+1;Ht<Se.length;Ht++){if(!(r[Se[Ht]]&(i|s))){wt=r[Se[Ht]]&it?b:y;break}Rt=Ht}for(var kt=Dt;kt<=Rt;kt++)r[Se[kt]]=It===wt?It:Nt(Se[kt]);St=Rt}}}for(var _t=p.start;_t<=p.end;_t++){var Lt=f[_t],Ot=r[_t];if(1&Lt?Ot&(y|F|E)&&f[_t]++:Ot&b?f[_t]++:Ot&(E|F)&&(f[_t]+=2),Ot&s&&(f[_t]=0===_t?p.level:f[_t-1]),_t===p.end||c(e[_t])&(S|T))for(var Pt=_t;Pt>=0&&c(e[Pt])&l;Pt--)f[Pt]=p.level}}return{levels:f,paragraphs:A};function Jt(t,n){for(var o=t;o<e.length;o++){var i=r[o];if(i&(b|U))return 1;if(i&(T|y)||n&&i===K)return 0;if(i&a){var s=Kt(o);o=-1===s?e.length:s}}return 0}function Kt(t){for(var n=1,o=t+1;o<e.length;o++){var i=r[o];if(i&T)break;if(i&K){if(0==--n)return o}else i&a&&n++}return-1}function Nt(e){return 1&f[e]?b:y}},e.getMirroredCharacter=j,e.getMirroredCharactersMap=function(e,t,r,n){var a=e.length;r=Math.max(0,null==r?0:+r),n=Math.min(a-1,null==n?a-1:+n);for(var o=new Map,i=r;i<=n;i++)if(1&t[i]){var s=j(e[i]);null!==s&&o.set(i,s)}return o},e.getReorderSegments=Q,e.getReorderedIndices=X,e.getReorderedString=function(e,t,r,n){var a=X(e,t,r,n),o=[].concat(e);return a.forEach((function(r,n){o[n]=(1&t.levels[r]?j(e[r]):null)||e[r]})),o.join("")},e.openingToClosingBracket=g,Object.defineProperty(e,"__esModule",{value:!0}),e}({})};const Ve=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Ze(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(e,t){let r=s.ShaderChunk[t];return r?Ze(r):e}))}const ze=[];for(let e=0;e<256;e++)ze[e]=(e<16?"0":"")+e.toString(16);const qe=Object.assign||function(){let e=arguments[0];for(let t=1,r=arguments.length;t<r;t++){let r=arguments[t];if(r)for(let t in r)r.hasOwnProperty(t)&&(e[t]=r[t])}return e},$e=Date.now(),et=new WeakMap,tt=new Map;let rt=1e10;function nt(e,t){const r=function(e){const t=JSON.stringify(e,ot);let r=st.get(t);null==r&&st.set(t,r=++it);return r}(t);let n=et.get(e);if(n||et.set(e,n=Object.create(null)),n[r])return new n[r];const a=`_onBeforeCompile${r}`,o=function(n){e.onBeforeCompile.call(this,n);const o=this.customProgramCacheKey()+"|"+n.vertexShader+"|"+n.fragmentShader;let i=tt[o];if(!i){const e=function({vertexShader:e,fragmentShader:t},r,n){let{vertexDefs:a,vertexMainIntro:o,vertexMainOutro:i,vertexTransform:s,fragmentDefs:l,fragmentMainIntro:u,fragmentMainOutro:c,fragmentColorTransform:d,customRewriter:f,timeUniform:h}=r;a=a||"",o=o||"",i=i||"",l=l||"",u=u||"",c=c||"",(s||f)&&(e=Ze(e));(d||f)&&(t=Ze(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n")));if(f){let r=f({vertexShader:e,fragmentShader:t});e=r.vertexShader,t=r.fragmentShader}if(d){let e=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,(t=>(e.push(t),""))),c=`${d}\n${e.join("\n")}\n${c}`}if(h){const e=`\nuniform float ${h};\n`;a=e+a,l=e+l}s&&(a=`${a}\nvoid troikaVertexTransform${n}(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  ${s}\n}\n`,o=`\ntroika_position_${n} = vec3(position);\ntroika_normal_${n} = vec3(normal);\ntroika_uv_${n} = vec2(uv);\ntroikaVertexTransform${n}(troika_position_${n}, troika_normal_${n}, troika_uv_${n});\n${o}\n`,e=(e=`vec3 troika_position_${n};\nvec3 troika_normal_${n};\nvec2 troika_uv_${n};\n${e}\n`).replace(/\b(position|normal|uv)\b/g,((e,t,r,a)=>/\battribute\s+vec[23]\s+$/.test(a.substr(0,r))?t:`troika_${t}_${n}`)));return e=at(e,n,a,o,i),t=at(t,n,l,u,c),{vertexShader:e,fragmentShader:t}}(n,t,r);i=tt[o]=e}n.vertexShader=i.vertexShader,n.fragmentShader=i.fragmentShader,qe(n.uniforms,this.uniforms),t.timeUniform&&(n.uniforms[t.timeUniform]={get value(){return Date.now()-$e}}),this[a]&&this[a](n)},i=function(){return l(t.chained?e:e.clone())},l=function(n){const a=Object.create(n,u);return Object.defineProperty(a,"baseMaterial",{value:e}),Object.defineProperty(a,"id",{value:rt++}),a.uuid=function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(ze[255&e]+ze[e>>8&255]+ze[e>>16&255]+ze[e>>24&255]+"-"+ze[255&t]+ze[t>>8&255]+"-"+ze[t>>16&15|64]+ze[t>>24&255]+"-"+ze[63&r|128]+ze[r>>8&255]+"-"+ze[r>>16&255]+ze[r>>24&255]+ze[255&n]+ze[n>>8&255]+ze[n>>16&255]+ze[n>>24&255]).toUpperCase()}(),a.uniforms=qe({},n.uniforms,t.uniforms),a.defines=qe({},n.defines,t.defines),a.defines[`TROIKA_DERIVED_MATERIAL_${r}`]="",a.extensions=qe({},n.extensions,t.extensions),a._listeners=void 0,a},u={constructor:{value:i},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return e.customProgramCacheKey()+"|"+r}},onBeforeCompile:{get(){return o},set(e){this[a]=e}},copy:{writable:!0,configurable:!0,value:function(t){return e.copy.call(this,t),e.isShaderMaterial||e.isDerivedMaterial||(qe(this.extensions,t.extensions),qe(this.defines,t.defines),qe(this.uniforms,s.UniformsUtils.clone(t.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const t=new e.constructor;return l(t).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let r=this._depthMaterial;return r||(r=this._depthMaterial=nt(e.isDerivedMaterial?e.getDepthMaterial():new s.MeshDepthMaterial({depthPacking:s.RGBADepthPacking}),t),r.defines.IS_DEPTH_MATERIAL="",r.uniforms=this.uniforms),r}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let r=this._distanceMaterial;return r||(r=this._distanceMaterial=nt(e.isDerivedMaterial?e.getDistanceMaterial():new s.MeshDistanceMaterial,t),r.defines.IS_DISTANCE_MATERIAL="",r.uniforms=this.uniforms),r}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:t,_distanceMaterial:r}=this;t&&t.dispose(),r&&r.dispose(),e.dispose.call(this)}}};return n[r]=i,new i}function at(e,t,r,n,a){return(n||a||r)&&(e=e.replace(Ve,`\n${r}\nvoid troikaOrigMain${t}() {`),e+=`\nvoid main() {\n  ${n}\n  troikaOrigMain${t}();\n  ${a}\n}`),e}function ot(e,t){return"uniforms"===e?void 0:"function"==typeof t?t.toString():t}let it=0;const st=new Map;s.DoubleSide;const lt=()=>(self.performance||Date).now(),ut=We();let ct;const dt=[];let ft=0;function ht(){const e=lt();for(;dt.length&&lt()-e<5;)dt.shift()();ft=dt.length?setTimeout(ht,0):0}const At=(...e)=>new Promise(((t,r)=>{dt.push((()=>{const n=lt();try{ut.webgl.generateIntoCanvas(...e),t({timing:lt()-n})}catch(e){r(e)}})),ft||(ft=setTimeout(ht,0))})),pt={};let Bt=0;function mt(e,t,r,n,a,o,i,s,l,u){const c="TroikaTextSDFGenerator_JS_"+Bt++%4;let d=pt[c];return d||(d=pt[c]={workerModule:je({name:c,workerId:c,dependencies:[We,lt],init(e,t){const r=e().javascript.generate;return function(...e){const n=t();return{textureData:r(...e),timing:t()-n}}},getTransferables(e){return[e.textureData.buffer]}}),requests:0,idleTimer:null}),d.requests++,clearTimeout(d.idleTimer),d.workerModule(e,t,r,n,a,o).then((({textureData:r,timing:n})=>{const a=lt(),o=new Uint8Array(4*r.length);for(let e=0;e<r.length;e++)o[4*e+u]=r[e];return ut.webglUtils.renderImageData(i,o,s,l,e,t,1<<3-u),n+=lt()-a,0==--d.requests&&(d.idleTimer=setTimeout((()=>{!function(e){Ke[e]&&Ke[e].forEach((function(e){e()})),Je[e]&&(Je[e].terminate(),delete Je[e])}(c)}),2e3)),{timing:n}}))}const gt=ut.webglUtils.resizeWebGLCanvasWithoutClearing;
/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/const vt=je({name:"Typr Font Parser",dependencies:[function(){return"undefined"==typeof window&&(self.window=self),function(e){var t={parse:function(e){var r=t._bin,n=new Uint8Array(e);if("ttcf"==r.readASCII(n,0,4)){var a=4;r.readUshort(n,a),a+=2,r.readUshort(n,a),a+=2;var o=r.readUint(n,a);a+=4;for(var i=[],s=0;s<o;s++){var l=r.readUint(n,a);a+=4,i.push(t._readFont(n,l))}return i}return[t._readFont(n,0)]},_readFont:function(e,r){var n=t._bin,a=r;n.readFixed(e,r),r+=4;var o=n.readUshort(e,r);r+=2,n.readUshort(e,r),r+=2,n.readUshort(e,r),r+=2,n.readUshort(e,r),r+=2;for(var i=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:e,_offset:a},l={},u=0;u<o;u++){var c=n.readASCII(e,r,4);r+=4,n.readUint(e,r),r+=4;var d=n.readUint(e,r);r+=4;var f=n.readUint(e,r);r+=4,l[c]={offset:d,length:f}}for(u=0;u<i.length;u++){var h=i[u];l[h]&&(s[h.trim()]=t[h.trim()].parse(e,l[h].offset,l[h].length,s))}return s},_tabOffset:function(e,r,n){for(var a=t._bin,o=a.readUshort(e,n+4),i=n+12,s=0;s<o;s++){var l=a.readASCII(e,i,4);i+=4,a.readUint(e,i),i+=4;var u=a.readUint(e,i);if(i+=4,a.readUint(e,i),i+=4,l==r)return u}return 0}};t._bin={readFixed:function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<8|e[t+3])/65540},readF2dot14:function(e,r){return t._bin.readShort(e,r)/16384},readInt:function(e,r){return t._bin._view(e).getInt32(r)},readInt8:function(e,r){return t._bin._view(e).getInt8(r)},readShort:function(e,r){return t._bin._view(e).getInt16(r)},readUshort:function(e,r){return t._bin._view(e).getUint16(r)},readUshorts:function(e,r,n){for(var a=[],o=0;o<n;o++)a.push(t._bin.readUshort(e,r+2*o));return a},readUint:function(e,r){return t._bin._view(e).getUint32(r)},readUint64:function(e,r){return 4294967296*t._bin.readUint(e,r)+t._bin.readUint(e,r+4)},readASCII:function(e,t,r){for(var n="",a=0;a<r;a++)n+=String.fromCharCode(e[t+a]);return n},readUnicode:function(e,t,r){for(var n="",a=0;a<r;a++){var o=e[t++]<<8|e[t++];n+=String.fromCharCode(o)}return n},_tdec:"undefined"!=typeof window&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(e,r,n){var a=t._bin._tdec;return a&&0==r&&n==e.length?a.decode(e):t._bin.readASCII(e,r,n)},readBytes:function(e,t,r){for(var n=[],a=0;a<r;a++)n.push(e[t+a]);return n},readASCIIArray:function(e,t,r){for(var n=[],a=0;a<r;a++)n.push(String.fromCharCode(e[t+a]));return n},_view:function(e){return e._dataView||(e._dataView=e.buffer?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(new Uint8Array(e).buffer))}},t._lctf={},t._lctf.parse=function(e,r,n,a,o){var i=t._bin,s={},l=r;i.readFixed(e,r),r+=4;var u=i.readUshort(e,r);r+=2;var c=i.readUshort(e,r);r+=2;var d=i.readUshort(e,r);return r+=2,s.scriptList=t._lctf.readScriptList(e,l+u),s.featureList=t._lctf.readFeatureList(e,l+c),s.lookupList=t._lctf.readLookupList(e,l+d,o),s},t._lctf.readLookupList=function(e,r,n){var a=t._bin,o=r,i=[],s=a.readUshort(e,r);r+=2;for(var l=0;l<s;l++){var u=a.readUshort(e,r);r+=2;var c=t._lctf.readLookupTable(e,o+u,n);i.push(c)}return i},t._lctf.readLookupTable=function(e,r,n){var a=t._bin,o=r,i={tabs:[]};i.ltype=a.readUshort(e,r),r+=2,i.flag=a.readUshort(e,r),r+=2;var s=a.readUshort(e,r);r+=2;for(var l=i.ltype,u=0;u<s;u++){var c=a.readUshort(e,r);r+=2;var d=n(e,l,o+c,i);i.tabs.push(d)}return i},t._lctf.numOfOnes=function(e){for(var t=0,r=0;r<32;r++)0!=(e>>>r&1)&&t++;return t},t._lctf.readClassDef=function(e,r){var n=t._bin,a=[],o=n.readUshort(e,r);if(r+=2,1==o){var i=n.readUshort(e,r);r+=2;var s=n.readUshort(e,r);r+=2;for(var l=0;l<s;l++)a.push(i+l),a.push(i+l),a.push(n.readUshort(e,r)),r+=2}if(2==o){var u=n.readUshort(e,r);for(r+=2,l=0;l<u;l++)a.push(n.readUshort(e,r)),r+=2,a.push(n.readUshort(e,r)),r+=2,a.push(n.readUshort(e,r)),r+=2}return a},t._lctf.getInterval=function(e,t){for(var r=0;r<e.length;r+=3){var n=e[r],a=e[r+1];if(e[r+2],n<=t&&t<=a)return r}return-1},t._lctf.readCoverage=function(e,r){var n=t._bin,a={};a.fmt=n.readUshort(e,r),r+=2;var o=n.readUshort(e,r);return r+=2,1==a.fmt&&(a.tab=n.readUshorts(e,r,o)),2==a.fmt&&(a.tab=n.readUshorts(e,r,3*o)),a},t._lctf.coverageIndex=function(e,r){var n=e.tab;if(1==e.fmt)return n.indexOf(r);if(2==e.fmt){var a=t._lctf.getInterval(n,r);if(-1!=a)return n[a+2]+(r-n[a])}return-1},t._lctf.readFeatureList=function(e,r){var n=t._bin,a=r,o=[],i=n.readUshort(e,r);r+=2;for(var s=0;s<i;s++){var l=n.readASCII(e,r,4);r+=4;var u=n.readUshort(e,r);r+=2;var c=t._lctf.readFeatureTable(e,a+u);c.tag=l.trim(),o.push(c)}return o},t._lctf.readFeatureTable=function(e,r){var n=t._bin,a=r,o={},i=n.readUshort(e,r);r+=2,i>0&&(o.featureParams=a+i);var s=n.readUshort(e,r);r+=2,o.tab=[];for(var l=0;l<s;l++)o.tab.push(n.readUshort(e,r+2*l));return o},t._lctf.readScriptList=function(e,r){var n=t._bin,a=r,o={},i=n.readUshort(e,r);r+=2;for(var s=0;s<i;s++){var l=n.readASCII(e,r,4);r+=4;var u=n.readUshort(e,r);r+=2,o[l.trim()]=t._lctf.readScriptTable(e,a+u)}return o},t._lctf.readScriptTable=function(e,r){var n=t._bin,a=r,o={},i=n.readUshort(e,r);r+=2,o.default=t._lctf.readLangSysTable(e,a+i);var s=n.readUshort(e,r);r+=2;for(var l=0;l<s;l++){var u=n.readASCII(e,r,4);r+=4;var c=n.readUshort(e,r);r+=2,o[u.trim()]=t._lctf.readLangSysTable(e,a+c)}return o},t._lctf.readLangSysTable=function(e,r){var n=t._bin,a={};n.readUshort(e,r),r+=2,a.reqFeature=n.readUshort(e,r),r+=2;var o=n.readUshort(e,r);return r+=2,a.features=n.readUshorts(e,r,o),a},t.CFF={},t.CFF.parse=function(e,r,n){var a=t._bin;(e=new Uint8Array(e.buffer,r,n))[r=0],e[++r],e[++r],e[++r],r++;var o=[];r=t.CFF.readIndex(e,r,o);for(var i=[],s=0;s<o.length-1;s++)i.push(a.readASCII(e,r+o[s],o[s+1]-o[s]));r+=o[o.length-1];var l=[];r=t.CFF.readIndex(e,r,l);var u=[];for(s=0;s<l.length-1;s++)u.push(t.CFF.readDict(e,r+l[s],r+l[s+1]));r+=l[l.length-1];var c=u[0],d=[];r=t.CFF.readIndex(e,r,d);var f=[];for(s=0;s<d.length-1;s++)f.push(a.readASCII(e,r+d[s],d[s+1]-d[s]));if(r+=d[d.length-1],t.CFF.readSubrs(e,r,c),c.CharStrings){r=c.CharStrings,d=[],r=t.CFF.readIndex(e,r,d);var h=[];for(s=0;s<d.length-1;s++)h.push(a.readBytes(e,r+d[s],d[s+1]-d[s]));c.CharStrings=h}if(c.ROS){r=c.FDArray;var A=[];for(r=t.CFF.readIndex(e,r,A),c.FDArray=[],s=0;s<A.length-1;s++){var p=t.CFF.readDict(e,r+A[s],r+A[s+1]);t.CFF._readFDict(e,p,f),c.FDArray.push(p)}r+=A[A.length-1],r=c.FDSelect,c.FDSelect=[];var B=e[r];if(r++,3!=B)throw B;var m=a.readUshort(e,r);for(r+=2,s=0;s<m+1;s++)c.FDSelect.push(a.readUshort(e,r),e[r+2]),r+=3}return c.Encoding&&(c.Encoding=t.CFF.readEncoding(e,c.Encoding,c.CharStrings.length)),c.charset&&(c.charset=t.CFF.readCharset(e,c.charset,c.CharStrings.length)),t.CFF._readFDict(e,c,f),c},t.CFF._readFDict=function(e,r,n){var a;for(var o in r.Private&&(a=r.Private[1],r.Private=t.CFF.readDict(e,a,a+r.Private[0]),r.Private.Subrs&&t.CFF.readSubrs(e,a+r.Private.Subrs,r.Private)),r)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(o)&&(r[o]=n[r[o]-426+35])},t.CFF.readSubrs=function(e,r,n){var a=t._bin,o=[];r=t.CFF.readIndex(e,r,o);var i,s=o.length;i=s<1240?107:s<33900?1131:32768,n.Bias=i,n.Subrs=[];for(var l=0;l<o.length-1;l++)n.Subrs.push(a.readBytes(e,r+o[l],o[l+1]-o[l]))},t.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],t.CFF.glyphByUnicode=function(e,t){for(var r=0;r<e.charset.length;r++)if(e.charset[r]==t)return r;return-1},t.CFF.glyphBySE=function(e,r){return r<0||r>255?-1:t.CFF.glyphByUnicode(e,t.CFF.tableSE[r])},t.CFF.readEncoding=function(e,r,n){t._bin;var a=[".notdef"],o=e[r];if(r++,0!=o)throw"error: unknown encoding format: "+o;var i=e[r];r++;for(var s=0;s<i;s++)a.push(e[r+s]);return a},t.CFF.readCharset=function(e,r,n){var a=t._bin,o=[".notdef"],i=e[r];if(r++,0==i)for(var s=0;s<n;s++){var l=a.readUshort(e,r);r+=2,o.push(l)}else{if(1!=i&&2!=i)throw"error: format: "+i;for(;o.length<n;){l=a.readUshort(e,r),r+=2;var u=0;for(1==i?(u=e[r],r++):(u=a.readUshort(e,r),r+=2),s=0;s<=u;s++)o.push(l),l++}}return o},t.CFF.readIndex=function(e,r,n){var a=t._bin,o=a.readUshort(e,r)+1,i=e[r+=2];if(r++,1==i)for(var s=0;s<o;s++)n.push(e[r+s]);else if(2==i)for(s=0;s<o;s++)n.push(a.readUshort(e,r+2*s));else if(3==i)for(s=0;s<o;s++)n.push(16777215&a.readUint(e,r+3*s-1));else if(1!=o)throw"unsupported offset size: "+i+", count: "+o;return(r+=o*i)-1},t.CFF.getCharString=function(e,r,n){var a=t._bin,o=e[r],i=e[r+1];e[r+2],e[r+3],e[r+4];var s=1,l=null,u=null;o<=20&&(l=o,s=1),12==o&&(l=100*o+i,s=2),21<=o&&o<=27&&(l=o,s=1),28==o&&(u=a.readShort(e,r+1),s=3),29<=o&&o<=31&&(l=o,s=1),32<=o&&o<=246&&(u=o-139,s=1),247<=o&&o<=250&&(u=256*(o-247)+i+108,s=2),251<=o&&o<=254&&(u=256*-(o-251)-i-108,s=2),255==o&&(u=a.readInt(e,r+1)/65535,s=5),n.val=null!=u?u:"o"+l,n.size=s},t.CFF.readCharString=function(e,r,n){for(var a=r+n,o=t._bin,i=[];r<a;){var s=e[r],l=e[r+1];e[r+2],e[r+3],e[r+4];var u=1,c=null,d=null;s<=20&&(c=s,u=1),12==s&&(c=100*s+l,u=2),19!=s&&20!=s||(c=s,u=2),21<=s&&s<=27&&(c=s,u=1),28==s&&(d=o.readShort(e,r+1),u=3),29<=s&&s<=31&&(c=s,u=1),32<=s&&s<=246&&(d=s-139,u=1),247<=s&&s<=250&&(d=256*(s-247)+l+108,u=2),251<=s&&s<=254&&(d=256*-(s-251)-l-108,u=2),255==s&&(d=o.readInt(e,r+1)/65535,u=5),i.push(null!=d?d:"o"+c),r+=u}return i},t.CFF.readDict=function(e,r,n){for(var a=t._bin,o={},i=[];r<n;){var s=e[r],l=e[r+1];e[r+2],e[r+3],e[r+4];var u=1,c=null,d=null;if(28==s&&(d=a.readShort(e,r+1),u=3),29==s&&(d=a.readInt(e,r+1),u=5),32<=s&&s<=246&&(d=s-139,u=1),247<=s&&s<=250&&(d=256*(s-247)+l+108,u=2),251<=s&&s<=254&&(d=256*-(s-251)-l-108,u=2),255==s)throw d=a.readInt(e,r+1)/65535,u=5,"unknown number";if(30==s){var f=[];for(u=1;;){var h=e[r+u];u++;var A=h>>4,p=15&h;if(15!=A&&f.push(A),15!=p&&f.push(p),15==p)break}for(var B="",m=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],g=0;g<f.length;g++)B+=m[f[g]];d=parseFloat(B)}s<=21&&(c=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],u=1,12==s&&(c=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][l],u=2)),null!=c?(o[c]=1==i.length?i[0]:i,i=[]):i.push(d),r+=u}return o},t.cmap={},t.cmap.parse=function(e,r,n){e=new Uint8Array(e.buffer,r,n),r=0;var a=t._bin,o={};a.readUshort(e,r),r+=2;var i=a.readUshort(e,r);r+=2;var s=[];o.tables=[];for(var l=0;l<i;l++){var u=a.readUshort(e,r);r+=2;var c=a.readUshort(e,r);r+=2;var d=a.readUint(e,r);r+=4;var f="p"+u+"e"+c,h=s.indexOf(d);if(-1==h){var A;h=o.tables.length,s.push(d);var p=a.readUshort(e,d);0==p?A=t.cmap.parse0(e,d):4==p?A=t.cmap.parse4(e,d):6==p?A=t.cmap.parse6(e,d):12==p?A=t.cmap.parse12(e,d):console.debug("unknown format: "+p,u,c,d),o.tables.push(A)}if(null!=o[f])throw"multiple tables for one platform+encoding";o[f]=h}return o},t.cmap.parse0=function(e,r){var n=t._bin,a={};a.format=n.readUshort(e,r),r+=2;var o=n.readUshort(e,r);r+=2,n.readUshort(e,r),r+=2,a.map=[];for(var i=0;i<o-6;i++)a.map.push(e[r+i]);return a},t.cmap.parse4=function(e,r){var n=t._bin,a=r,o={};o.format=n.readUshort(e,r),r+=2;var i=n.readUshort(e,r);r+=2,n.readUshort(e,r),r+=2;var s=n.readUshort(e,r);r+=2;var l=s/2;o.searchRange=n.readUshort(e,r),r+=2,o.entrySelector=n.readUshort(e,r),r+=2,o.rangeShift=n.readUshort(e,r),r+=2,o.endCount=n.readUshorts(e,r,l),r+=2*l,r+=2,o.startCount=n.readUshorts(e,r,l),r+=2*l,o.idDelta=[];for(var u=0;u<l;u++)o.idDelta.push(n.readShort(e,r)),r+=2;for(o.idRangeOffset=n.readUshorts(e,r,l),r+=2*l,o.glyphIdArray=[];r<a+i;)o.glyphIdArray.push(n.readUshort(e,r)),r+=2;return o},t.cmap.parse6=function(e,r){var n=t._bin,a={};a.format=n.readUshort(e,r),r+=2,n.readUshort(e,r),r+=2,n.readUshort(e,r),r+=2,a.firstCode=n.readUshort(e,r),r+=2;var o=n.readUshort(e,r);r+=2,a.glyphIdArray=[];for(var i=0;i<o;i++)a.glyphIdArray.push(n.readUshort(e,r)),r+=2;return a},t.cmap.parse12=function(e,r){var n=t._bin,a={};a.format=n.readUshort(e,r),r+=2,r+=2,n.readUint(e,r),r+=4,n.readUint(e,r),r+=4;var o=n.readUint(e,r);r+=4,a.groups=[];for(var i=0;i<o;i++){var s=r+12*i,l=n.readUint(e,s+0),u=n.readUint(e,s+4),c=n.readUint(e,s+8);a.groups.push([l,u,c])}return a},t.glyf={},t.glyf.parse=function(e,t,r,n){for(var a=[],o=0;o<n.maxp.numGlyphs;o++)a.push(null);return a},t.glyf._parseGlyf=function(e,r){var n=t._bin,a=e._data,o=t._tabOffset(a,"glyf",e._offset)+e.loca[r];if(e.loca[r]==e.loca[r+1])return null;var i={};if(i.noc=n.readShort(a,o),o+=2,i.xMin=n.readShort(a,o),o+=2,i.yMin=n.readShort(a,o),o+=2,i.xMax=n.readShort(a,o),o+=2,i.yMax=n.readShort(a,o),o+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(n.readUshort(a,o)),o+=2;var l=n.readUshort(a,o);if(o+=2,a.length-o<l)return null;i.instructions=n.readBytes(a,o,l),o+=l;var u=i.endPts[i.noc-1]+1;for(i.flags=[],s=0;s<u;s++){var c=a[o];if(o++,i.flags.push(c),0!=(8&c)){var d=a[o];o++;for(var f=0;f<d;f++)i.flags.push(c),s++}}for(i.xs=[],s=0;s<u;s++){var h=0!=(2&i.flags[s]),A=0!=(16&i.flags[s]);h?(i.xs.push(A?a[o]:-a[o]),o++):A?i.xs.push(0):(i.xs.push(n.readShort(a,o)),o+=2)}for(i.ys=[],s=0;s<u;s++)h=0!=(4&i.flags[s]),A=0!=(32&i.flags[s]),h?(i.ys.push(A?a[o]:-a[o]),o++):A?i.ys.push(0):(i.ys.push(n.readShort(a,o)),o+=2);var p=0,B=0;for(s=0;s<u;s++)p+=i.xs[s],B+=i.ys[s],i.xs[s]=p,i.ys[s]=B}else{var m;i.parts=[];do{m=n.readUshort(a,o),o+=2;var g={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(g),g.glyphIndex=n.readUshort(a,o),o+=2,1&m){var v=n.readShort(a,o);o+=2;var C=n.readShort(a,o);o+=2}else v=n.readInt8(a,o),o++,C=n.readInt8(a,o),o++;2&m?(g.m.tx=v,g.m.ty=C):(g.p1=v,g.p2=C),8&m?(g.m.a=g.m.d=n.readF2dot14(a,o),o+=2):64&m?(g.m.a=n.readF2dot14(a,o),o+=2,g.m.d=n.readF2dot14(a,o),o+=2):128&m&&(g.m.a=n.readF2dot14(a,o),o+=2,g.m.b=n.readF2dot14(a,o),o+=2,g.m.c=n.readF2dot14(a,o),o+=2,g.m.d=n.readF2dot14(a,o),o+=2)}while(32&m);if(256&m){var y=n.readUshort(a,o);for(o+=2,i.instr=[],s=0;s<y;s++)i.instr.push(a[o]),o++}}return i},t.GPOS={},t.GPOS.parse=function(e,r,n,a){return t._lctf.parse(e,r,n,a,t.GPOS.subt)},t.GPOS.subt=function(e,r,n,a){var o=t._bin,i=n,s={};if(s.fmt=o.readUshort(e,n),n+=2,1==r||2==r||3==r||7==r||8==r&&s.fmt<=2){var l=o.readUshort(e,n);n+=2,s.coverage=t._lctf.readCoverage(e,l+i)}if(1==r&&1==s.fmt){var u=o.readUshort(e,n);n+=2;var c=t._lctf.numOfOnes(u);0!=u&&(s.pos=t.GPOS.readValueRecord(e,n,u))}else if(2==r&&s.fmt>=1&&s.fmt<=2){u=o.readUshort(e,n),n+=2;var d=o.readUshort(e,n);n+=2,c=t._lctf.numOfOnes(u);var f=t._lctf.numOfOnes(d);if(1==s.fmt){s.pairsets=[];var h=o.readUshort(e,n);n+=2;for(var A=0;A<h;A++){var p=i+o.readUshort(e,n);n+=2;var B=o.readUshort(e,p);p+=2;for(var m=[],g=0;g<B;g++){var v=o.readUshort(e,p);p+=2,0!=u&&(G=t.GPOS.readValueRecord(e,p,u),p+=2*c),0!=d&&(E=t.GPOS.readValueRecord(e,p,d),p+=2*f),m.push({gid2:v,val1:G,val2:E})}s.pairsets.push(m)}}if(2==s.fmt){var C=o.readUshort(e,n);n+=2;var y=o.readUshort(e,n);n+=2;var b=o.readUshort(e,n);n+=2;var F=o.readUshort(e,n);for(n+=2,s.classDef1=t._lctf.readClassDef(e,i+C),s.classDef2=t._lctf.readClassDef(e,i+y),s.matrix=[],A=0;A<b;A++){var M=[];for(g=0;g<F;g++){var G=null,E=null;0!=u&&(G=t.GPOS.readValueRecord(e,n,u),n+=2*c),0!=d&&(E=t.GPOS.readValueRecord(e,n,d),n+=2*f),M.push({val1:G,val2:E})}s.matrix.push(M)}}}else{if(9==r&&1==s.fmt){var x=o.readUshort(e,n);n+=2;var T=o.readUint(e,n);if(n+=4,9==a.ltype)a.ltype=x;else if(a.ltype!=x)throw"invalid extension substitution";return t.GPOS.subt(e,a.ltype,i+T)}console.debug("unsupported GPOS table LookupType",r,"format",s.fmt)}return s},t.GPOS.readValueRecord=function(e,r,n){var a=t._bin,o=[];return o.push(1&n?a.readShort(e,r):0),r+=1&n?2:0,o.push(2&n?a.readShort(e,r):0),r+=2&n?2:0,o.push(4&n?a.readShort(e,r):0),r+=4&n?2:0,o.push(8&n?a.readShort(e,r):0),r+=8&n?2:0,o},t.GSUB={},t.GSUB.parse=function(e,r,n,a){return t._lctf.parse(e,r,n,a,t.GSUB.subt)},t.GSUB.subt=function(e,r,n,a){var o=t._bin,i=n,s={};if(s.fmt=o.readUshort(e,n),n+=2,1!=r&&4!=r&&5!=r&&6!=r)return null;if(1==r||4==r||5==r&&s.fmt<=2||6==r&&s.fmt<=2){var l=o.readUshort(e,n);n+=2,s.coverage=t._lctf.readCoverage(e,i+l)}if(1==r&&s.fmt>=1&&s.fmt<=2){if(1==s.fmt)s.delta=o.readShort(e,n),n+=2;else if(2==s.fmt){var u=o.readUshort(e,n);n+=2,s.newg=o.readUshorts(e,n,u),n+=2*s.newg.length}}else if(4==r){s.vals=[],u=o.readUshort(e,n),n+=2;for(var c=0;c<u;c++){var d=o.readUshort(e,n);n+=2,s.vals.push(t.GSUB.readLigatureSet(e,i+d))}}else if(5==r&&2==s.fmt){if(2==s.fmt){var f=o.readUshort(e,n);n+=2,s.cDef=t._lctf.readClassDef(e,i+f),s.scset=[];var h=o.readUshort(e,n);for(n+=2,c=0;c<h;c++){var A=o.readUshort(e,n);n+=2,s.scset.push(0==A?null:t.GSUB.readSubClassSet(e,i+A))}}}else if(6==r&&3==s.fmt){if(3==s.fmt){for(c=0;c<3;c++){u=o.readUshort(e,n),n+=2;for(var p=[],B=0;B<u;B++)p.push(t._lctf.readCoverage(e,i+o.readUshort(e,n+2*B)));n+=2*u,0==c&&(s.backCvg=p),1==c&&(s.inptCvg=p),2==c&&(s.ahedCvg=p)}u=o.readUshort(e,n),n+=2,s.lookupRec=t.GSUB.readSubstLookupRecords(e,n,u)}}else{if(7==r&&1==s.fmt){var m=o.readUshort(e,n);n+=2;var g=o.readUint(e,n);if(n+=4,9==a.ltype)a.ltype=m;else if(a.ltype!=m)throw"invalid extension substitution";return t.GSUB.subt(e,a.ltype,i+g)}console.debug("unsupported GSUB table LookupType",r,"format",s.fmt)}return s},t.GSUB.readSubClassSet=function(e,r){var n=t._bin.readUshort,a=r,o=[],i=n(e,r);r+=2;for(var s=0;s<i;s++){var l=n(e,r);r+=2,o.push(t.GSUB.readSubClassRule(e,a+l))}return o},t.GSUB.readSubClassRule=function(e,r){var n=t._bin.readUshort,a={},o=n(e,r),i=n(e,r+=2);r+=2,a.input=[];for(var s=0;s<o-1;s++)a.input.push(n(e,r)),r+=2;return a.substLookupRecords=t.GSUB.readSubstLookupRecords(e,r,i),a},t.GSUB.readSubstLookupRecords=function(e,r,n){for(var a=t._bin.readUshort,o=[],i=0;i<n;i++)o.push(a(e,r),a(e,r+2)),r+=4;return o},t.GSUB.readChainSubClassSet=function(e,r){var n=t._bin,a=r,o=[],i=n.readUshort(e,r);r+=2;for(var s=0;s<i;s++){var l=n.readUshort(e,r);r+=2,o.push(t.GSUB.readChainSubClassRule(e,a+l))}return o},t.GSUB.readChainSubClassRule=function(e,r){for(var n=t._bin,a={},o=["backtrack","input","lookahead"],i=0;i<o.length;i++){var s=n.readUshort(e,r);r+=2,1==i&&s--,a[o[i]]=n.readUshorts(e,r,s),r+=2*a[o[i]].length}return s=n.readUshort(e,r),r+=2,a.subst=n.readUshorts(e,r,2*s),r+=2*a.subst.length,a},t.GSUB.readLigatureSet=function(e,r){var n=t._bin,a=r,o=[],i=n.readUshort(e,r);r+=2;for(var s=0;s<i;s++){var l=n.readUshort(e,r);r+=2,o.push(t.GSUB.readLigature(e,a+l))}return o},t.GSUB.readLigature=function(e,r){var n=t._bin,a={chain:[]};a.nglyph=n.readUshort(e,r),r+=2;var o=n.readUshort(e,r);r+=2;for(var i=0;i<o-1;i++)a.chain.push(n.readUshort(e,r)),r+=2;return a},t.head={},t.head.parse=function(e,r,n){var a=t._bin,o={};return a.readFixed(e,r),r+=4,o.fontRevision=a.readFixed(e,r),r+=4,a.readUint(e,r),r+=4,a.readUint(e,r),r+=4,o.flags=a.readUshort(e,r),r+=2,o.unitsPerEm=a.readUshort(e,r),r+=2,o.created=a.readUint64(e,r),r+=8,o.modified=a.readUint64(e,r),r+=8,o.xMin=a.readShort(e,r),r+=2,o.yMin=a.readShort(e,r),r+=2,o.xMax=a.readShort(e,r),r+=2,o.yMax=a.readShort(e,r),r+=2,o.macStyle=a.readUshort(e,r),r+=2,o.lowestRecPPEM=a.readUshort(e,r),r+=2,o.fontDirectionHint=a.readShort(e,r),r+=2,o.indexToLocFormat=a.readShort(e,r),r+=2,o.glyphDataFormat=a.readShort(e,r),r+=2,o},t.hhea={},t.hhea.parse=function(e,r,n){var a=t._bin,o={};return a.readFixed(e,r),r+=4,o.ascender=a.readShort(e,r),r+=2,o.descender=a.readShort(e,r),r+=2,o.lineGap=a.readShort(e,r),r+=2,o.advanceWidthMax=a.readUshort(e,r),r+=2,o.minLeftSideBearing=a.readShort(e,r),r+=2,o.minRightSideBearing=a.readShort(e,r),r+=2,o.xMaxExtent=a.readShort(e,r),r+=2,o.caretSlopeRise=a.readShort(e,r),r+=2,o.caretSlopeRun=a.readShort(e,r),r+=2,o.caretOffset=a.readShort(e,r),r+=2,r+=8,o.metricDataFormat=a.readShort(e,r),r+=2,o.numberOfHMetrics=a.readUshort(e,r),r+=2,o},t.hmtx={},t.hmtx.parse=function(e,r,n,a){for(var o=t._bin,i={aWidth:[],lsBearing:[]},s=0,l=0,u=0;u<a.maxp.numGlyphs;u++)u<a.hhea.numberOfHMetrics&&(s=o.readUshort(e,r),r+=2,l=o.readShort(e,r),r+=2),i.aWidth.push(s),i.lsBearing.push(l);return i},t.kern={},t.kern.parse=function(e,r,n,a){var o=t._bin,i=o.readUshort(e,r);if(r+=2,1==i)return t.kern.parseV1(e,r-2,n,a);var s=o.readUshort(e,r);r+=2;for(var l={glyph1:[],rval:[]},u=0;u<s;u++){r+=2,n=o.readUshort(e,r),r+=2;var c=o.readUshort(e,r);r+=2;var d=c>>>8;if(0!=(d&=15))throw"unknown kern table format: "+d;r=t.kern.readFormat0(e,r,l)}return l},t.kern.parseV1=function(e,r,n,a){var o=t._bin;o.readFixed(e,r),r+=4;var i=o.readUint(e,r);r+=4;for(var s={glyph1:[],rval:[]},l=0;l<i;l++){o.readUint(e,r),r+=4;var u=o.readUshort(e,r);r+=2,o.readUshort(e,r),r+=2;var c=u>>>8;if(0!=(c&=15))throw"unknown kern table format: "+c;r=t.kern.readFormat0(e,r,s)}return s},t.kern.readFormat0=function(e,r,n){var a=t._bin,o=-1,i=a.readUshort(e,r);r+=2,a.readUshort(e,r),r+=2,a.readUshort(e,r),r+=2,a.readUshort(e,r),r+=2;for(var s=0;s<i;s++){var l=a.readUshort(e,r);r+=2;var u=a.readUshort(e,r);r+=2;var c=a.readShort(e,r);r+=2,l!=o&&(n.glyph1.push(l),n.rval.push({glyph2:[],vals:[]}));var d=n.rval[n.rval.length-1];d.glyph2.push(u),d.vals.push(c),o=l}return r},t.loca={},t.loca.parse=function(e,r,n,a){var o=t._bin,i=[],s=a.head.indexToLocFormat,l=a.maxp.numGlyphs+1;if(0==s)for(var u=0;u<l;u++)i.push(o.readUshort(e,r+(u<<1))<<1);if(1==s)for(u=0;u<l;u++)i.push(o.readUint(e,r+(u<<2)));return i},t.maxp={},t.maxp.parse=function(e,r,n){var a=t._bin,o={},i=a.readUint(e,r);return r+=4,o.numGlyphs=a.readUshort(e,r),r+=2,65536==i&&(o.maxPoints=a.readUshort(e,r),r+=2,o.maxContours=a.readUshort(e,r),r+=2,o.maxCompositePoints=a.readUshort(e,r),r+=2,o.maxCompositeContours=a.readUshort(e,r),r+=2,o.maxZones=a.readUshort(e,r),r+=2,o.maxTwilightPoints=a.readUshort(e,r),r+=2,o.maxStorage=a.readUshort(e,r),r+=2,o.maxFunctionDefs=a.readUshort(e,r),r+=2,o.maxInstructionDefs=a.readUshort(e,r),r+=2,o.maxStackElements=a.readUshort(e,r),r+=2,o.maxSizeOfInstructions=a.readUshort(e,r),r+=2,o.maxComponentElements=a.readUshort(e,r),r+=2,o.maxComponentDepth=a.readUshort(e,r),r+=2),o},t.name={},t.name.parse=function(e,r,n){var a=t._bin,o={};a.readUshort(e,r),r+=2;var i=a.readUshort(e,r);r+=2,a.readUshort(e,r);for(var s,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],u=r+=2,c=0;c<i;c++){var d=a.readUshort(e,r);r+=2;var f=a.readUshort(e,r);r+=2;var h=a.readUshort(e,r);r+=2;var A=a.readUshort(e,r);r+=2;var p=a.readUshort(e,r);r+=2;var B=a.readUshort(e,r);r+=2;var m,g=l[A],v=u+12*i+B;if(0==d)m=a.readUnicode(e,v,p/2);else if(3==d&&0==f)m=a.readUnicode(e,v,p/2);else if(0==f)m=a.readASCII(e,v,p);else if(1==f)m=a.readUnicode(e,v,p/2);else if(3==f)m=a.readUnicode(e,v,p/2);else{if(1!=d)throw"unknown encoding "+f+", platformID: "+d;m=a.readASCII(e,v,p),console.debug("reading unknown MAC encoding "+f+" as ASCII")}var C="p"+d+","+h.toString(16);null==o[C]&&(o[C]={}),o[C][void 0!==g?g:A]=m,o[C]._lang=h}for(var y in o)if(null!=o[y].postScriptName&&1033==o[y]._lang)return o[y];for(var y in o)if(null!=o[y].postScriptName&&0==o[y]._lang)return o[y];for(var y in o)if(null!=o[y].postScriptName&&3084==o[y]._lang)return o[y];for(var y in o)if(null!=o[y].postScriptName)return o[y];for(var y in o){s=y;break}return console.debug("returning name table with languageID "+o[s]._lang),o[s]},t["OS/2"]={},t["OS/2"].parse=function(e,r,n){var a=t._bin.readUshort(e,r);r+=2;var o={};if(0==a)t["OS/2"].version0(e,r,o);else if(1==a)t["OS/2"].version1(e,r,o);else if(2==a||3==a||4==a)t["OS/2"].version2(e,r,o);else{if(5!=a)throw"unknown OS/2 table version: "+a;t["OS/2"].version5(e,r,o)}return o},t["OS/2"].version0=function(e,r,n){var a=t._bin;return n.xAvgCharWidth=a.readShort(e,r),r+=2,n.usWeightClass=a.readUshort(e,r),r+=2,n.usWidthClass=a.readUshort(e,r),r+=2,n.fsType=a.readUshort(e,r),r+=2,n.ySubscriptXSize=a.readShort(e,r),r+=2,n.ySubscriptYSize=a.readShort(e,r),r+=2,n.ySubscriptXOffset=a.readShort(e,r),r+=2,n.ySubscriptYOffset=a.readShort(e,r),r+=2,n.ySuperscriptXSize=a.readShort(e,r),r+=2,n.ySuperscriptYSize=a.readShort(e,r),r+=2,n.ySuperscriptXOffset=a.readShort(e,r),r+=2,n.ySuperscriptYOffset=a.readShort(e,r),r+=2,n.yStrikeoutSize=a.readShort(e,r),r+=2,n.yStrikeoutPosition=a.readShort(e,r),r+=2,n.sFamilyClass=a.readShort(e,r),r+=2,n.panose=a.readBytes(e,r,10),r+=10,n.ulUnicodeRange1=a.readUint(e,r),r+=4,n.ulUnicodeRange2=a.readUint(e,r),r+=4,n.ulUnicodeRange3=a.readUint(e,r),r+=4,n.ulUnicodeRange4=a.readUint(e,r),r+=4,n.achVendID=[a.readInt8(e,r),a.readInt8(e,r+1),a.readInt8(e,r+2),a.readInt8(e,r+3)],r+=4,n.fsSelection=a.readUshort(e,r),r+=2,n.usFirstCharIndex=a.readUshort(e,r),r+=2,n.usLastCharIndex=a.readUshort(e,r),r+=2,n.sTypoAscender=a.readShort(e,r),r+=2,n.sTypoDescender=a.readShort(e,r),r+=2,n.sTypoLineGap=a.readShort(e,r),r+=2,n.usWinAscent=a.readUshort(e,r),r+=2,n.usWinDescent=a.readUshort(e,r),r+2},t["OS/2"].version1=function(e,r,n){var a=t._bin;return r=t["OS/2"].version0(e,r,n),n.ulCodePageRange1=a.readUint(e,r),r+=4,n.ulCodePageRange2=a.readUint(e,r),r+4},t["OS/2"].version2=function(e,r,n){var a=t._bin;return r=t["OS/2"].version1(e,r,n),n.sxHeight=a.readShort(e,r),r+=2,n.sCapHeight=a.readShort(e,r),r+=2,n.usDefault=a.readUshort(e,r),r+=2,n.usBreak=a.readUshort(e,r),r+=2,n.usMaxContext=a.readUshort(e,r),r+2},t["OS/2"].version5=function(e,r,n){var a=t._bin;return r=t["OS/2"].version2(e,r,n),n.usLowerOpticalPointSize=a.readUshort(e,r),r+=2,n.usUpperOpticalPointSize=a.readUshort(e,r),r+2},t.post={},t.post.parse=function(e,r,n){var a=t._bin,o={};return o.version=a.readFixed(e,r),r+=4,o.italicAngle=a.readFixed(e,r),r+=4,o.underlinePosition=a.readShort(e,r),r+=2,o.underlineThickness=a.readShort(e,r),r+=2,o},null==t&&(t={}),null==t.U&&(t.U={}),t.U.codeToGlyph=function(e,t){var r=e.cmap,n=-1;if(null!=r.p0e4?n=r.p0e4:null!=r.p3e1?n=r.p3e1:null!=r.p1e0?n=r.p1e0:null!=r.p0e3&&(n=r.p0e3),-1==n)throw"no familiar platform and encoding!";var a=r.tables[n];if(0==a.format)return t>=a.map.length?0:a.map[t];if(4==a.format){for(var o=-1,i=0;i<a.endCount.length;i++)if(t<=a.endCount[i]){o=i;break}return-1==o||a.startCount[o]>t?0:65535&(0!=a.idRangeOffset[o]?a.glyphIdArray[t-a.startCount[o]+(a.idRangeOffset[o]>>1)-(a.idRangeOffset.length-o)]:t+a.idDelta[o])}if(12==a.format){if(t>a.groups[a.groups.length-1][1])return 0;for(i=0;i<a.groups.length;i++){var s=a.groups[i];if(s[0]<=t&&t<=s[1])return s[2]+(t-s[0])}return 0}throw"unknown cmap table format "+a.format},t.U.glyphToPath=function(e,r){var n={cmds:[],crds:[]};if(e.SVG&&e.SVG.entries[r]){var a=e.SVG.entries[r];return null==a?n:("string"==typeof a&&(a=t.SVG.toPath(a),e.SVG.entries[r]=a),a)}if(e.CFF){var o={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:e.CFF.Private?e.CFF.Private.defaultWidthX:0,open:!1},i=e.CFF,s=e.CFF.Private;if(i.ROS){for(var l=0;i.FDSelect[l+2]<=r;)l+=2;s=i.FDArray[i.FDSelect[l+1]].Private}t.U._drawCFF(e.CFF.CharStrings[r],o,i,s,n)}else e.glyf&&t.U._drawGlyf(r,e,n);return n},t.U._drawGlyf=function(e,r,n){var a=r.glyf[e];null==a&&(a=r.glyf[e]=t.glyf._parseGlyf(r,e)),null!=a&&(a.noc>-1?t.U._simpleGlyph(a,n):t.U._compoGlyph(a,r,n))},t.U._simpleGlyph=function(e,r){for(var n=0;n<e.noc;n++){for(var a=0==n?0:e.endPts[n-1]+1,o=e.endPts[n],i=a;i<=o;i++){var s=i==a?o:i-1,l=i==o?a:i+1,u=1&e.flags[i],c=1&e.flags[s],d=1&e.flags[l],f=e.xs[i],h=e.ys[i];if(i==a)if(u){if(!c){t.U.P.moveTo(r,f,h);continue}t.U.P.moveTo(r,e.xs[s],e.ys[s])}else c?t.U.P.moveTo(r,e.xs[s],e.ys[s]):t.U.P.moveTo(r,(e.xs[s]+f)/2,(e.ys[s]+h)/2);u?c&&t.U.P.lineTo(r,f,h):d?t.U.P.qcurveTo(r,f,h,e.xs[l],e.ys[l]):t.U.P.qcurveTo(r,f,h,(f+e.xs[l])/2,(h+e.ys[l])/2)}t.U.P.closePath(r)}},t.U._compoGlyph=function(e,r,n){for(var a=0;a<e.parts.length;a++){var o={cmds:[],crds:[]},i=e.parts[a];t.U._drawGlyf(i.glyphIndex,r,o);for(var s=i.m,l=0;l<o.crds.length;l+=2){var u=o.crds[l],c=o.crds[l+1];n.crds.push(u*s.a+c*s.b+s.tx),n.crds.push(u*s.c+c*s.d+s.ty)}for(l=0;l<o.cmds.length;l++)n.cmds.push(o.cmds[l])}},t.U._getGlyphClass=function(e,r){var n=t._lctf.getInterval(r,e);return-1==n?0:r[n+2]},t.U.getPairAdjustment=function(e,r,n){var a=!1;if(e.GPOS)for(var o=e.GPOS,i=o.lookupList,s=o.featureList,l=[],u=0;u<s.length;u++){var c=s[u];if("kern"==c.tag){a=!0;for(var d=0;d<c.tab.length;d++)if(!l[c.tab[d]]){l[c.tab[d]]=!0;for(var f=i[c.tab[d]],h=0;h<f.tabs.length;h++)if(null!=f.tabs[h]){var A,p=f.tabs[h];if(!p.coverage||-1!=(A=t._lctf.coverageIndex(p.coverage,r)))if(1==f.ltype);else if(2==f.ltype){var B=null;if(1==p.fmt){var m=p.pairsets[A];for(u=0;u<m.length;u++)m[u].gid2==n&&(B=m[u])}else if(2==p.fmt){var g=t.U._getGlyphClass(r,p.classDef1),v=t.U._getGlyphClass(n,p.classDef2);B=p.matrix[g][v]}if(B){var C=0;return B.val1&&B.val1[2]&&(C+=B.val1[2]),B.val2&&B.val2[0]&&(C+=B.val2[0]),C}}}}}}if(e.kern&&!a){var y=e.kern.glyph1.indexOf(r);if(-1!=y){var b=e.kern.rval[y].glyph2.indexOf(n);if(-1!=b)return e.kern.rval[y].vals[b]}}return 0},t.U._applySubs=function(e,r,n,a){for(var o=e.length-r-1,i=0;i<n.tabs.length;i++)if(null!=n.tabs[i]){var s,l=n.tabs[i];if(!l.coverage||-1!=(s=t._lctf.coverageIndex(l.coverage,e[r])))if(1==n.ltype)e[r],1==l.fmt?e[r]=e[r]+l.delta:e[r]=l.newg[s];else if(4==n.ltype)for(var u=l.vals[s],c=0;c<u.length;c++){var d=u[c],f=d.chain.length;if(!(f>o)){for(var h=!0,A=0,p=0;p<f;p++){for(;-1==e[r+A+(1+p)];)A++;d.chain[p]!=e[r+A+(1+p)]&&(h=!1)}if(h){for(e[r]=d.nglyph,p=0;p<f+A;p++)e[r+p+1]=-1;break}}}else if(5==n.ltype&&2==l.fmt)for(var B=t._lctf.getInterval(l.cDef,e[r]),m=l.cDef[B+2],g=l.scset[m],v=0;v<g.length;v++){var C=g[v],y=C.input;if(!(y.length>o)){for(h=!0,p=0;p<y.length;p++){var b=t._lctf.getInterval(l.cDef,e[r+1+p]);if(-1==B&&l.cDef[b+2]!=y[p]){h=!1;break}}if(h){var F=C.substLookupRecords;for(c=0;c<F.length;c+=2)F[c],F[c+1]}}}else if(6==n.ltype&&3==l.fmt){if(!t.U._glsCovered(e,l.backCvg,r-l.backCvg.length))continue;if(!t.U._glsCovered(e,l.inptCvg,r))continue;if(!t.U._glsCovered(e,l.ahedCvg,r+l.inptCvg.length))continue;var M=l.lookupRec;for(v=0;v<M.length;v+=2){B=M[v];var G=a[M[v+1]];t.U._applySubs(e,r+B,G,a)}}}},t.U._glsCovered=function(e,r,n){for(var a=0;a<r.length;a++)if(-1==t._lctf.coverageIndex(r[a],e[n+a]))return!1;return!0},t.U.glyphsToPath=function(e,r,n){for(var a={cmds:[],crds:[]},o=0,i=0;i<r.length;i++){var s=r[i];if(-1!=s){for(var l=i<r.length-1&&-1!=r[i+1]?r[i+1]:0,u=t.U.glyphToPath(e,s),c=0;c<u.crds.length;c+=2)a.crds.push(u.crds[c]+o),a.crds.push(u.crds[c+1]);for(n&&a.cmds.push(n),c=0;c<u.cmds.length;c++)a.cmds.push(u.cmds[c]);n&&a.cmds.push("X"),o+=e.hmtx.aWidth[s],i<r.length-1&&(o+=t.U.getPairAdjustment(e,s,l))}}return a},t.U.P={},t.U.P.moveTo=function(e,t,r){e.cmds.push("M"),e.crds.push(t,r)},t.U.P.lineTo=function(e,t,r){e.cmds.push("L"),e.crds.push(t,r)},t.U.P.curveTo=function(e,t,r,n,a,o,i){e.cmds.push("C"),e.crds.push(t,r,n,a,o,i)},t.U.P.qcurveTo=function(e,t,r,n,a){e.cmds.push("Q"),e.crds.push(t,r,n,a)},t.U.P.closePath=function(e){e.cmds.push("Z")},t.U._drawCFF=function(e,r,n,a,o){for(var i=r.stack,s=r.nStems,l=r.haveWidth,u=r.width,c=r.open,d=0,f=r.x,h=r.y,A=0,p=0,B=0,m=0,g=0,v=0,C=0,y=0,b=0,F=0,M={val:0,size:0};d<e.length;){t.CFF.getCharString(e,d,M);var G=M.val;if(d+=M.size,"o1"==G||"o18"==G)i.length%2!=0&&!l&&(u=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,l=!0;else if("o3"==G||"o23"==G)i.length%2!=0&&!l&&(u=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,l=!0;else if("o4"==G)i.length>1&&!l&&(u=i.shift()+a.nominalWidthX,l=!0),c&&t.U.P.closePath(o),h+=i.pop(),t.U.P.moveTo(o,f,h),c=!0;else if("o5"==G)for(;i.length>0;)f+=i.shift(),h+=i.shift(),t.U.P.lineTo(o,f,h);else if("o6"==G||"o7"==G)for(var E=i.length,x="o6"==G,T=0;T<E;T++){var S=i.shift();x?f+=S:h+=S,x=!x,t.U.P.lineTo(o,f,h)}else if("o8"==G||"o24"==G){E=i.length;for(var D=0;D+6<=E;)A=f+i.shift(),p=h+i.shift(),B=A+i.shift(),m=p+i.shift(),f=B+i.shift(),h=m+i.shift(),t.U.P.curveTo(o,A,p,B,m,f,h),D+=6;"o24"==G&&(f+=i.shift(),h+=i.shift(),t.U.P.lineTo(o,f,h))}else{if("o11"==G)break;if("o1234"==G||"o1235"==G||"o1236"==G||"o1237"==G)"o1234"==G&&(p=h,B=(A=f+i.shift())+i.shift(),F=m=p+i.shift(),v=m,y=h,f=(C=(g=(b=B+i.shift())+i.shift())+i.shift())+i.shift(),t.U.P.curveTo(o,A,p,B,m,b,F),t.U.P.curveTo(o,g,v,C,y,f,h)),"o1235"==G&&(A=f+i.shift(),p=h+i.shift(),B=A+i.shift(),m=p+i.shift(),b=B+i.shift(),F=m+i.shift(),g=b+i.shift(),v=F+i.shift(),C=g+i.shift(),y=v+i.shift(),f=C+i.shift(),h=y+i.shift(),i.shift(),t.U.P.curveTo(o,A,p,B,m,b,F),t.U.P.curveTo(o,g,v,C,y,f,h)),"o1236"==G&&(A=f+i.shift(),p=h+i.shift(),B=A+i.shift(),F=m=p+i.shift(),v=m,C=(g=(b=B+i.shift())+i.shift())+i.shift(),y=v+i.shift(),f=C+i.shift(),t.U.P.curveTo(o,A,p,B,m,b,F),t.U.P.curveTo(o,g,v,C,y,f,h)),"o1237"==G&&(A=f+i.shift(),p=h+i.shift(),B=A+i.shift(),m=p+i.shift(),b=B+i.shift(),F=m+i.shift(),g=b+i.shift(),v=F+i.shift(),C=g+i.shift(),y=v+i.shift(),Math.abs(C-f)>Math.abs(y-h)?f=C+i.shift():h=y+i.shift(),t.U.P.curveTo(o,A,p,B,m,b,F),t.U.P.curveTo(o,g,v,C,y,f,h));else if("o14"==G){if(i.length>0&&!l&&(u=i.shift()+n.nominalWidthX,l=!0),4==i.length){var R=i.shift(),I=i.shift(),U=i.shift(),w=i.shift(),H=t.CFF.glyphBySE(n,U),k=t.CFF.glyphBySE(n,w);t.U._drawCFF(n.CharStrings[H],r,n,a,o),r.x=R,r.y=I,t.U._drawCFF(n.CharStrings[k],r,n,a,o)}c&&(t.U.P.closePath(o),c=!1)}else if("o19"==G||"o20"==G)i.length%2!=0&&!l&&(u=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,l=!0,d+=s+7>>3;else if("o21"==G)i.length>2&&!l&&(u=i.shift()+a.nominalWidthX,l=!0),h+=i.pop(),f+=i.pop(),c&&t.U.P.closePath(o),t.U.P.moveTo(o,f,h),c=!0;else if("o22"==G)i.length>1&&!l&&(u=i.shift()+a.nominalWidthX,l=!0),f+=i.pop(),c&&t.U.P.closePath(o),t.U.P.moveTo(o,f,h),c=!0;else if("o25"==G){for(;i.length>6;)f+=i.shift(),h+=i.shift(),t.U.P.lineTo(o,f,h);A=f+i.shift(),p=h+i.shift(),B=A+i.shift(),m=p+i.shift(),f=B+i.shift(),h=m+i.shift(),t.U.P.curveTo(o,A,p,B,m,f,h)}else if("o26"==G)for(i.length%2&&(f+=i.shift());i.length>0;)A=f,p=h+i.shift(),f=B=A+i.shift(),h=(m=p+i.shift())+i.shift(),t.U.P.curveTo(o,A,p,B,m,f,h);else if("o27"==G)for(i.length%2&&(h+=i.shift());i.length>0;)p=h,B=(A=f+i.shift())+i.shift(),m=p+i.shift(),f=B+i.shift(),h=m,t.U.P.curveTo(o,A,p,B,m,f,h);else if("o10"==G||"o29"==G){var _="o10"==G?a:n;if(0==i.length)console.debug("error: empty stack");else{var L=i.pop(),O=_.Subrs[L+_.Bias];r.x=f,r.y=h,r.nStems=s,r.haveWidth=l,r.width=u,r.open=c,t.U._drawCFF(O,r,n,a,o),f=r.x,h=r.y,s=r.nStems,l=r.haveWidth,u=r.width,c=r.open}}else if("o30"==G||"o31"==G){var P=i.length,J=(D=0,"o31"==G);for(D+=P-(E=-3&P);D<E;)J?(p=h,B=(A=f+i.shift())+i.shift(),h=(m=p+i.shift())+i.shift(),E-D==5?(f=B+i.shift(),D++):f=B,J=!1):(A=f,p=h+i.shift(),B=A+i.shift(),m=p+i.shift(),f=B+i.shift(),E-D==5?(h=m+i.shift(),D++):h=m,J=!0),t.U.P.curveTo(o,A,p,B,m,f,h),D+=4}else{if("o"==(G+"").charAt(0))throw console.debug("Unknown operation: "+G,e),G;i.push(G)}}}r.x=f,r.y=h,r.nStems=s,r.haveWidth=l,r.width=u,r.open=c};var r=t,n={Typr:r};return e.Typr=r,e.default=n,Object.defineProperty(e,"__esModule",{value:!0}),e}({}).Typr}
/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/,function(){return function(e){var t=Uint8Array,r=Uint16Array,n=Uint32Array,a=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),i=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(e,t){for(var a=new r(31),o=0;o<31;++o)a[o]=t+=1<<e[o-1];var i=new n(a[30]);for(o=1;o<30;++o)for(var s=a[o];s<a[o+1];++s)i[s]=s-a[o]<<5|o;return[a,i]},l=s(a,2),u=l[0],c=l[1];u[28]=258,c[258]=28;for(var d=s(o,0)[0],f=new r(32768),h=0;h<32768;++h){var A=(43690&h)>>>1|(21845&h)<<1;A=(61680&(A=(52428&A)>>>2|(13107&A)<<2))>>>4|(3855&A)<<4,f[h]=((65280&A)>>>8|(255&A)<<8)>>>1}var p=function(e,t,n){for(var a=e.length,o=0,i=new r(t);o<a;++o)++i[e[o]-1];var s,l=new r(t);for(o=0;o<t;++o)l[o]=l[o-1]+i[o-1]<<1;if(n){s=new r(1<<t);var u=15-t;for(o=0;o<a;++o)if(e[o])for(var c=o<<4|e[o],d=t-e[o],h=l[e[o]-1]++<<d,A=h|(1<<d)-1;h<=A;++h)s[f[h]>>>u]=c}else for(s=new r(a),o=0;o<a;++o)e[o]&&(s[o]=f[l[e[o]-1]++]>>>15-e[o]);return s},B=new t(288);for(h=0;h<144;++h)B[h]=8;for(h=144;h<256;++h)B[h]=9;for(h=256;h<280;++h)B[h]=7;for(h=280;h<288;++h)B[h]=8;var m=new t(32);for(h=0;h<32;++h)m[h]=5;var g=p(B,9,1),v=p(m,5,1),C=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},y=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},b=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},F=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],M=function(e,t,r){var n=new Error(t||F[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,M),!r)throw n;return n},G=function(e,s,l){var c=e.length;if(!c||l&&!l.l&&c<5)return s||new t(0);var f=!s||l,h=!l||l.i;l||(l={}),s||(s=new t(3*c));var A,B=function(e){var r=s.length;if(e>r){var n=new t(Math.max(2*r,e));n.set(s),s=n}},m=l.f||0,F=l.p||0,G=l.b||0,E=l.l,x=l.d,T=l.m,S=l.n,D=8*c;do{if(!E){l.f=m=y(e,F,1);var R=y(e,F+1,3);if(F+=3,!R){var I=e[(N=((A=F)/8|0)+(7&A&&1)+4)-4]|e[N-3]<<8,U=N+I;if(U>c){h&&M(0);break}f&&B(G+I),s.set(e.subarray(N,U),G),l.b=G+=I,l.p=F=8*U;continue}if(1==R)E=g,x=v,T=9,S=5;else if(2==R){var w=y(e,F,31)+257,H=y(e,F+10,15)+4,k=w+y(e,F+5,31)+1;F+=14;for(var _=new t(k),L=new t(19),O=0;O<H;++O)L[i[O]]=y(e,F+3*O,7);F+=3*H;var P=C(L),J=(1<<P)-1,K=p(L,P,1);for(O=0;O<k;){var N,j=K[y(e,F,J)];if(F+=15&j,(N=j>>>4)<16)_[O++]=N;else{var Q=0,X=0;for(16==N?(X=3+y(e,F,3),F+=2,Q=_[O-1]):17==N?(X=3+y(e,F,7),F+=3):18==N&&(X=11+y(e,F,127),F+=7);X--;)_[O++]=Q}}var W=_.subarray(0,w),Y=_.subarray(w);T=C(W),S=C(Y),E=p(W,T,1),x=p(Y,S,1)}else M(1);if(F>D){h&&M(0);break}}f&&B(G+131072);for(var V=(1<<T)-1,Z=(1<<S)-1,z=F;;z=F){var q=(Q=E[b(e,F)&V])>>>4;if((F+=15&Q)>D){h&&M(0);break}if(Q||M(2),q<256)s[G++]=q;else{if(256==q){z=F,E=null;break}var $=q-254;if(q>264){var ee=a[O=q-257];$=y(e,F,(1<<ee)-1)+u[O],F+=ee}var te=x[b(e,F)&Z],re=te>>>4;if(te||M(3),F+=15&te,Y=d[re],re>3&&(ee=o[re],Y+=b(e,F)&(1<<ee)-1,F+=ee),F>D){h&&M(0);break}f&&B(G+131072);for(var ne=G+$;G<ne;G+=4)s[G]=s[G-Y],s[G+1]=s[G+1-Y],s[G+2]=s[G+2-Y],s[G+3]=s[G+3-Y];G=ne}}l.l=E,l.p=z,l.b=G,E&&(m=1,l.m=T,l.d=x,l.n=S)}while(!m);return G==s.length?s:function(e,a,o){(null==a||a<0)&&(a=0),(null==o||o>e.length)&&(o=e.length);var i=new(e instanceof r?r:e instanceof n?n:t)(o-a);return i.set(e.subarray(a,o)),i}(s,0,G)},E=new t(0),x="undefined"!=typeof TextDecoder&&new TextDecoder;try{x.decode(E,{stream:!0})}catch(e){}return e.convert_streams=function(e){var t=new DataView(e),r=0;function n(){var e=t.getUint16(r);return r+=2,e}function a(){var e=t.getUint32(r);return r+=4,e}function o(e){m.setUint16(g,e),g+=2}function i(e){m.setUint32(g,e),g+=4}for(var s={signature:a(),flavor:a(),length:a(),numTables:n(),reserved:n(),totalSfntSize:a(),majorVersion:n(),minorVersion:n(),metaOffset:a(),metaLength:a(),metaOrigLength:a(),privOffset:a(),privLength:a()},l=0;Math.pow(2,l)<=s.numTables;)l++;l--;for(var u=16*Math.pow(2,l),c=16*s.numTables-u,d=12,f=[],h=0;h<s.numTables;h++)f.push({tag:a(),offset:a(),compLength:a(),origLength:a(),origChecksum:a()}),d+=16;var A,p=new Uint8Array(12+16*f.length+f.reduce((function(e,t){return e+t.origLength+4}),0)),B=p.buffer,m=new DataView(B),g=0;return i(s.flavor),o(s.numTables),o(u),o(l),o(c),f.forEach((function(e){i(e.tag),i(e.origChecksum),i(d),i(e.origLength),e.outOffset=d,(d+=e.origLength)%4!=0&&(d+=4-d%4)})),f.forEach((function(t){var r,n=e.slice(t.offset,t.offset+t.compLength);if(t.compLength!=t.origLength){var a=new Uint8Array(t.origLength);r=new Uint8Array(n,2),G(r,a)}else a=new Uint8Array(n);p.set(a,t.outOffset);var o=0;(d=t.outOffset+t.origLength)%4!=0&&(o=4-d%4),p.set(new Uint8Array(o).buffer,t.outOffset+t.origLength),A=d+o})),B.slice(0,A)},Object.defineProperty(e,"__esModule",{value:!0}),e}({}).convert_streams},function(e,t){const r={M:2,L:2,Q:4,C:6,Z:0},n={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"};let a;function o(e){if(!a){const e={R:2,L:1,D:4,C:16,U:32,T:8};a=new Map;for(let t in n){let r=0;n[t].split(",").forEach((n=>{let[o,i]=n.split("+");o=parseInt(o,36),i=i?parseInt(i,36):0,a.set(r+=o,e[t]);for(let n=i;n--;)a.set(++r,e[t])}))}}return a.get(e)||32}const i=[null,"isol","init","fina","medi"];function s(e){const t=new Uint8Array(e.length);let r=32,n=1,a=-1;for(let i=0;i<e.length;i++){const s=e.codePointAt(i);let l=0|o(s),u=1;8&l||(21&r?22&l?(u=3,1!==n&&3!==n||t[a]++):33&l&&(2!==n&&4!==n||t[a]--):34&r&&(2!==n&&4!==n||t[a]--),n=t[i]=u,r=l,a=i,s>65535&&i++)}return t}function l(...e){for(let t=0;t<e.length;t++)if("number"==typeof e[t])return e[t]}function u(t){const n=Object.create(null),a=t["OS/2"],o=t.hhea,u=t.head.unitsPerEm,c=l(a&&a.sTypoAscender,o&&o.ascender,u),d={unitsPerEm:u,ascender:c,descender:l(a&&a.sTypoDescender,o&&o.descender,0),capHeight:l(a&&a.sCapHeight,c),xHeight:l(a&&a.sxHeight,c),lineGap:l(a&&a.sTypoLineGap,o&&o.lineGap),forEachGlyph(a,o,l,u){let c=0;const f=1/d.unitsPerEm*o,h=function(t,r){const n=[];for(let a=0;a<r.length;a++){const o=r.codePointAt(a);o>65535&&a++,n.push(e.U.codeToGlyph(t,o))}const a=t.GSUB;if(a){const{lookupList:t,featureList:o}=a;let l;const u=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,c=[];o.forEach((a=>{if(u.test(a.tag))for(let o=0;o<a.tab.length;o++){if(c[a.tab[o]])continue;c[a.tab[o]]=!0;const u=t[a.tab[o]],d=/^(isol|init|fina|medi)$/.test(a.tag);d&&!l&&(l=s(r));for(let r=0;r<n.length;r++)l&&d&&i[l[r]]!==a.tag||e.U._applySubs(n,r,u,t)}}))}return n}(t,a);let A=0,p=-1;return h.forEach(((i,s)=>{if(-1!==i){let a=n[i];if(!a){const{cmds:o,crds:s}=e.U.glyphToPath(t,i);let l,u,c,d,f="",h=0;for(let e=0,t=o.length;e<t;e++){const t=r[o[e]];f+=o[e];for(let e=1;e<=t;e++)f+=(e>1?",":"")+s[h++]}if(s.length){l=u=1/0,c=d=-1/0;for(let e=0,t=s.length;e<t;e+=2){let t=s[e],r=s[e+1];t<l&&(l=t),r<u&&(u=r),t>c&&(c=t),r>d&&(d=r)}}else l=c=u=d=0;a=n[i]={index:i,advanceWidth:t.hmtx.aWidth[i],xMin:l,yMin:u,xMax:c,yMax:d,path:f,pathCommandCount:o.length}}-1!==p&&(c+=e.U.getPairAdjustment(t,p,i)*f),u.call(null,a,c,A),a.advanceWidth&&(c+=a.advanceWidth*f),l&&(c+=l*o),p=i}A+=a.codePointAt(A)>65535?2:1})),c}};return d}return function(r){const n=new Uint8Array(r,0,4),a=e._bin.readASCII(n,0,4);if("wOFF"===a)r=t(r);else if("wOF2"===a)throw new Error("woff2 fonts not supported");return u(e.parse(r)[0])}}],init(e,t,r){return r(e(),t())}}),Ct={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},yt=new s.Color;let bt=!1;function Ft(){return(self.performance||Date).now()}const Mt=Object.create(null);function Gt(e,t){bt=!0,e=xt({},e);const r=Ft();if(e.font=function(e){Tt||(Tt="undefined"==typeof document?{}:document.createElement("a"));return Tt.href=e,Tt.href}(e.font||Ct.defaultFontURL),e.text=""+e.text,e.sdfGlyphSize=e.sdfGlyphSize||Ct.sdfGlyphSize,null!=e.colorRanges){let t={};for(let r in e.colorRanges)if(e.colorRanges.hasOwnProperty(r)){let n=e.colorRanges[r];"number"!=typeof n&&(n=yt.set(n).getHex()),t[r]=n}e.colorRanges=t}Object.freeze(e);const{textureWidth:n,sdfExponent:a}=Ct,{sdfGlyphSize:o}=e,i=n/o*4;let l=Mt[o];if(!l){const e=document.createElement("canvas");e.width=n,e.height=256*o/i,l=Mt[o]={glyphCount:0,sdfGlyphSize:o,sdfCanvas:e,sdfTexture:new s.Texture(e,void 0,void 0,void 0,s.LinearFilter,s.LinearFilter),contextLost:!1,glyphsByFont:new Map},l.sdfTexture.generateMipmaps=!1,function(e){const t=e.sdfCanvas;t.addEventListener("webglcontextlost",(t=>{console.log("Context Lost",t),t.preventDefault(),e.contextLost=!0})),t.addEventListener("webglcontextrestored",(t=>{console.log("Context Restored",t),e.contextLost=!1;const r=[];e.glyphsByFont.forEach((t=>{t.forEach((t=>{r.push(Et(t,e,!0))}))})),Promise.all(r).then((()=>{St(e),e.sdfTexture.needsUpdate=!0}))}))}(l)}const{sdfTexture:u,sdfCanvas:c}=l;let d=l.glyphsByFont.get(e.font);d||l.glyphsByFont.set(e.font,d=new Map),Rt(e).then((s=>{const{glyphIds:f,glyphPositions:h,fontSize:A,unitsPerEm:p,timings:B}=s,m=[],g=new Float32Array(4*f.length),v=A/p;let C=0,y=0;const b=Ft();f.forEach(((e,t)=>{let r=d.get(e);if(!r){const{path:t,pathBounds:n}=s.glyphData[e],a=Math.max(n[2]-n[0],n[3]-n[1])/o*(Ct.sdfMargin*o+.5),i=l.glyphCount++,u=[n[0]-a,n[1]-a,n[2]+a,n[3]+a];d.set(e,r={path:t,atlasIndex:i,sdfViewBox:u}),m.push(r)}const{sdfViewBox:n}=r,a=h[y++],i=h[y++];g[C++]=a+n[0]*v,g[C++]=i+n[1]*v,g[C++]=a+n[2]*v,g[C++]=i+n[3]*v,f[t]=r.atlasIndex})),B.quads=(B.quads||0)+(Ft()-b);const F=Ft();B.sdf={};const M=c.height,G=Math.ceil(l.glyphCount/i),E=Math.pow(2,Math.ceil(Math.log2(G*o)));E>M&&(console.info(`Increasing SDF texture size ${M}->${E}`),gt(c,n,E),u.dispose()),Promise.all(m.map((t=>Et(t,l,e.gpuAccelerateSDF).then((({timing:e})=>{B.sdf[t.atlasIndex]=e}))))).then((()=>{m.length&&!l.contextLost&&(St(l),u.needsUpdate=!0),B.sdfTotal=Ft()-F,B.total=Ft()-r,t(Object.freeze({parameters:e,sdfTexture:u,sdfGlyphSize:o,sdfExponent:a,glyphBounds:g,glyphAtlasIndices:f,glyphColors:s.glyphColors,caretPositions:s.caretPositions,caretHeight:s.caretHeight,chunkedBounds:s.chunkedBounds,ascender:s.ascender,descender:s.descender,lineHeight:s.lineHeight,capHeight:s.capHeight,xHeight:s.xHeight,topBaseline:s.topBaseline,blockBounds:s.blockBounds,visibleBounds:s.visibleBounds,timings:s.timings}))}))})),Promise.resolve().then((()=>{var e;l.contextLost||(e=c)._warm||(ut.webgl.isSupported(e),e._warm=!0)}))}function Et({path:e,atlasIndex:t,sdfViewBox:r},{sdfGlyphSize:n,sdfCanvas:a,contextLost:o},i){if(o)return Promise.resolve({timing:-1});const{textureWidth:s,sdfExponent:l}=Ct,u=Math.max(r[2]-r[0],r[3]-r[1]),c=Math.floor(t/4);return function(e,t,r,n,a,o,i,s,l,u,c=!0){return c?At(e,t,r,n,a,o,i,s,l,u).then(null,(c=>(ct||(console.warn("WebGL SDF generation failed, falling back to JS",c),ct=!0),mt(e,t,r,n,a,o,i,s,l,u)))):mt(e,t,r,n,a,o,i,s,l,u)}(n,n,e,r,u,l,a,c%(s/n)*n,Math.floor(c/(s/n))*n,t%4,i)}function xt(e,t){for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}let Tt;function St(e){if("function"!=typeof createImageBitmap){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:t,sdfTexture:r}=e,{width:n,height:a}=t,o=e.sdfCanvas.getContext("webgl");let i=r.image.data;i&&i.length===n*a*4||(i=new Uint8Array(n*a*4),r.image={width:n,height:a,data:i},r.flipY=!1,r.isDataTexture=!0),o.readPixels(0,0,n,a,o.RGBA,o.UNSIGNED_BYTE,i)}}const Dt=je({name:"Typesetter",dependencies:[Ct,vt,function(e,t,r){const{defaultFontURL:n}=r,a=Object.create(null),o=1/0,i=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,s="[^\\S\\u00A0]",l=new RegExp("[^\\S\\u00A0]|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]");function u(t,r){t||(t=n);let o=a[t];o?o.pending?o.pending.push(r):r(o):(a[t]={pending:[r]},function(t,r){!function a(){const o=e=>{console.error(`Failure loading font ${t}${t===n?"":"; trying fallback"}`,e),t!==n&&(t=n,a())};try{const n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){if(n.status>=400)o(new Error(n.statusText));else if(n.status>0)try{const t=e(n.response);r(t)}catch(e){o(e)}},n.onerror=o,n.send()}catch(e){o(e)}}()}(t,(e=>{let r=a[t].pending;a[t]=e,r.forEach((t=>t(e)))})))}function c({text:e="",font:r=n,sdfGlyphSize:a=64,fontSize:c=1,letterSpacing:p=0,lineHeight:B="normal",maxWidth:m=o,direction:g,textAlign:v="left",textIndent:C=0,whiteSpace:y="normal",overflowWrap:b="normal",anchorX:F=0,anchorY:M=0,includeCaretPositions:G=!1,chunkedBoundsSize:E=8192,colorRanges:x=null},T,S=!1){const D=h(),R={fontLoad:0,typesetting:0};e.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")),c=+c,p=+p,m=+m,B=B||"normal",C=+C,u(r,(r=>{const n=isFinite(m);let a=null,u=null,I=null,U=null,w=null,H=null,k=null,_=0,L=0,O="nowrap"!==y;const{ascender:P,descender:J,unitsPerEm:K,lineGap:N,capHeight:j,xHeight:Q}=r;R.fontLoad=h()-D;const X=h(),W=c/K;"normal"===B&&(B=(P-J+N)/K);const Y=((B*=c)-(P-J)*W)/2,V=-(P*W+Y),Z=Math.min(B,(P-J)*W),z=(P+J)/2*W-Z/2;let q=C,$=new A;const ee=[$];r.forEachGlyph(e,c,p,((t,r,a)=>{const o=e.charAt(a),u=t.advanceWidth*W,d=$.count;let f;if("isEmpty"in t||(t.isWhitespace=!!o&&new RegExp(s).test(o),t.canBreakAfter=!!o&&l.test(o),t.isEmpty=t.xMin===t.xMax||t.yMin===t.yMax||i.test(o)),t.isWhitespace||t.isEmpty||L++,O&&n&&!t.isWhitespace&&r+u+q>m&&d){if($.glyphAt(d-1).glyphObj.canBreakAfter)f=new A,q=-r;else for(let e=d;e--;){if(0===e&&"break-word"===b){f=new A,q=-r;break}if($.glyphAt(e).glyphObj.canBreakAfter){f=$.splitAt(e+1);const t=f.glyphAt(0).x;q-=t;for(let e=f.count;e--;)f.glyphAt(e).x-=t;break}}f&&($.isSoftWrapped=!0,$=f,ee.push($),_=m)}let h=$.glyphAt($.count);h.glyphObj=t,h.x=r+q,h.width=u,h.charIndex=a,"\n"===o&&($=new A,ee.push($),q=-(r+u+p*c)+C)})),ee.forEach((e=>{for(let t=e.count;t--;){let{glyphObj:r,x:n,width:a}=e.glyphAt(t);if(!r.isWhitespace)return e.width=n+a,void(e.width>_&&(_=e.width))}}));let te=0,re=0;if(F&&("number"==typeof F?te=-F:"string"==typeof F&&(te=-_*("left"===F?0:"center"===F?.5:"right"===F?1:d(F)))),M)if("number"==typeof M)re=-M;else if("string"==typeof M){let e=ee.length*B;re="top"===M?0:"top-baseline"===M?-V:"top-cap"===M?-V-j*W:"top-ex"===M?-V-Q*W:"middle"===M?e/2:"bottom"===M?e:"bottom-baseline"===M?e-Y+J*W:d(M)*e}if(!S){const n=t.getEmbeddingLevels(e,g);a=new Uint16Array(L),u=new Float32Array(2*L),I={},H=[o,o,-1/0,-1/0],k=[];let i=V;G&&(w=new Float32Array(3*e.length)),x&&(U=new Uint8Array(3*L));let s,l,c=0,d=-1,h=-1;if(ee.forEach(((A,p)=>{let{count:m,width:g}=A;if(m>0){let p=0;for(let e=m;e--&&A.glyphAt(e).glyphObj.isWhitespace;)p++;let B=0,C=0;if("center"===v)B=(_-g)/2;else if("right"===v)B=_-g;else if("justify"===v&&A.isSoftWrapped){let e=0;for(let t=m-p;t--;)A.glyphAt(t).glyphObj.isWhitespace&&e++;C=(_-g)/e}if(C||B){let e=0;for(let t=0;t<m;t++){let r=A.glyphAt(t);const n=r.glyphObj;r.x+=B+e,0!==C&&n.isWhitespace&&t<m-p&&(e+=C,r.width+=C)}}const y=t.getReorderSegments(e,n,A.glyphAt(0).charIndex,A.glyphAt(A.count-1).charIndex);for(let e=0;e<y.length;e++){const[t,r]=y[e];let n=1/0,a=-1/0;for(let e=0;e<m;e++)if(A.glyphAt(e).charIndex>=t){let t=e,o=e;for(;o<m;o++){let e=A.glyphAt(o);if(e.charIndex>r)break;o<m-p&&(n=Math.min(n,e.x),a=Math.max(a,e.x+e.width))}for(let e=t;e<o;e++){const t=A.glyphAt(e);t.x=a-(t.x+t.width-n)}break}}let b;const F=e=>b=e;for(let p=0;p<m;p++){let B=A.glyphAt(p);b=B.glyphObj;const m=b.index,g=1&n.levels[B.charIndex];if(g){const n=t.getMirroredCharacter(e[B.charIndex]);n&&r.forEachGlyph(n,0,0,F)}if(G){const{charIndex:e}=B,t=B.x+te,r=B.x+B.width+te;w[3*e]=g?r:t,w[3*e+1]=g?t:r,w[3*e+2]=i+z+re;const n=e-d;n>1&&f(w,d,n),d=e}if(x){const{charIndex:e}=B;for(;e>h;)h++,x.hasOwnProperty(h)&&(l=x[h])}if(!b.isWhitespace&&!b.isEmpty){const e=c++;I[m]||(I[m]={path:b.path,pathBounds:[b.xMin,b.yMin,b.xMax,b.yMax]});const t=B.x+te,r=i+re;u[2*e]=t,u[2*e+1]=r;const n=t+b.xMin*W,d=r+b.yMin*W,f=t+b.xMax*W,h=r+b.yMax*W;n<H[0]&&(H[0]=n),d<H[1]&&(H[1]=d),f>H[2]&&(H[2]=f),h>H[3]&&(H[3]=h),e%E==0&&(s={start:e,end:e,rect:[o,o,-1/0,-1/0]},k.push(s)),s.end++;const A=s.rect;if(n<A[0]&&(A[0]=n),d<A[1]&&(A[1]=d),f>A[2]&&(A[2]=f),h>A[3]&&(A[3]=h),a[e]=m,x){const t=3*e;U[t]=l>>16&255,U[t+1]=l>>8&255,U[t+2]=255&l}}}}i-=B})),w){const t=e.length-d;t>1&&f(w,d,t)}}R.typesetting=h()-X,T({glyphIds:a,glyphPositions:u,glyphData:I,caretPositions:w,caretHeight:Z,glyphColors:U,chunkedBounds:k,fontSize:c,unitsPerEm:K,ascender:P*W,descender:J*W,capHeight:j*W,xHeight:Q*W,lineHeight:B,topBaseline:V,blockBounds:[te,re-ee.length*B,te+_,re],visibleBounds:H,timings:R})}))}function d(e){let t=e.match(/^([\d.]+)%$/),r=t?parseFloat(t[1]):NaN;return isNaN(r)?0:r/100}function f(e,t,r){const n=e[3*t],a=e[3*t+1],o=e[3*t+2],i=(a-n)/r;for(let a=0;a<r;a++){const r=3*(t+a);e[r]=n+i*a,e[r+1]=n+i*(a+1),e[r+2]=o}}function h(){return(self.performance||Date).now()}function A(){this.data=[]}const p=["glyphObj","x","width","charIndex"];return A.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/p.length)},glyphAt(e){let t=A.flyweight;return t.data=this.data,t.index=e,t},splitAt(e){let t=new A;return t.data=this.data.splice(e*p.length),t}},A.flyweight=p.reduce(((e,t,r,n)=>(Object.defineProperty(e,t,{get(){return this.data[this.index*p.length+r]},set(e){this.data[this.index*p.length+r]=e}}),e)),{data:null,index:0}),{typeset:c,measure:function(e,t){c(e,(e=>{const[r,n,a,o]=e.blockBounds;t({width:a-r,height:o-n})}),{metricsOnly:!0})},loadFont:u}},Ye],init(e,t,r,n){const{defaultFontURL:a}=e;return r(t,n(),{defaultFontURL:a})}}),Rt=je({name:"Typesetter",dependencies:[Dt],init(e){return function(t){return new Promise((r=>{e.typeset(t,r)}))}},getTransferables(e){const t=[e.glyphPositions.buffer,e.glyphIds.buffer];return e.caretPositions&&t.push(e.caretPositions.buffer),e.glyphColors&&t.push(e.glyphColors.buffer),t}});const It={};const Ut="aTroikaGlyphIndex";class wt extends s.InstancedBufferGeometry{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new s.Sphere,this.boundingBox=new s.Box3}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const t=this.getIndex().count;this.setDrawRange(e===s.BackSide?t/2:0,e===s.DoubleSide?t:t/2)}set detail(e){if(e!==this._detail){this._detail=e,("number"!=typeof e||e<1)&&(e=1);let t=function(e){let t=It[e];if(!t){const r=new s.PlaneGeometry(1,1,e,e),n=r.clone(),a=r.attributes,o=n.attributes,i=new s.BufferGeometry,l=a.uv.count;for(let e=0;e<l;e++)o.position.array[3*e]*=-1,o.normal.array[3*e+2]*=-1;["position","normal","uv"].forEach((e=>{i.setAttribute(e,new s.Float32BufferAttribute([...a[e].array,...o[e].array],a[e].itemSize))})),i.setIndex([...r.index.array,...n.index.array.map((e=>e+l))]),i.translate(.5,.5,0),t=It[e]=i}return t}(e);["position","normal","uv"].forEach((e=>{this.attributes[e]=t.attributes[e].clone()})),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,r,n,a){Ht(this,"aTroikaGlyphBounds",e,4),Ht(this,Ut,t,1),Ht(this,"aTroikaGlyphColor",a,3),this._blockBounds=r,this._chunkedBounds=n,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:r}=this;if(t){const{PI:n,floor:a,min:o,max:i,sin:s,cos:l}=Math,u=n/2,c=2*n,d=Math.abs(t),f=e[0]/d,h=e[2]/d,A=a((f+u)/c)!==a((h+u)/c)?-d:o(s(f)*d,s(h)*d),p=a((f-u)/c)!==a((h-u)/c)?d:i(s(f)*d,s(h)*d),B=a((f+n)/c)!==a((h+n)/c)?2*d:i(d-l(f)*d,d-l(h)*d);r.min.set(A,e[1],t<0?-B:0),r.max.set(p,e[3],t<0?0:B)}else r.min.set(e[0],e[1],0),r.max.set(e[2],e[3],0);r.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(Ut).count,r=this._chunkedBounds;if(r)for(let n=r.length;n--;){t=r[n].end;let a=r[n].rect;if(a[1]<e.w&&a[3]>e.y&&a[0]<e.z&&a[2]>e.x)break}this.instanceCount=t}}function Ht(e,t,r,n){const a=e.getAttribute(t);r?a&&a.array.length===r.length?(a.array.set(r),a.needsUpdate=!0):(e.setAttribute(t,new s.InstancedBufferAttribute(r,n)),delete e._maxInstanceCount,e.dispose()):a&&e.deleteAttribute(t)}const kt=new s.MeshBasicMaterial({color:16777215,side:s.DoubleSide,transparent:!0}),_t=8421504,Lt=new s.Matrix4,Ot=new s.Vector3,Pt=new s.Vector3,Jt=[],Kt=new s.Vector3,Nt="+x+y";function jt(e){return Array.isArray(e)?e[0]:e}let Qt=()=>{const e=new s.Mesh(new s.PlaneGeometry(1,1),kt);return Qt=()=>e,e},Xt=()=>{const e=new s.Mesh(new s.PlaneGeometry(1,1,32,1),kt);return Xt=()=>e,e};const Wt={type:"syncstart"},Yt={type:"synccomplete"},Vt=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Zt=Vt.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class zt extends s.Mesh{constructor(){super(new wt,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=_t,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=Nt,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(Wt),Gt({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},(t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const r=this._queuedSyncs;r&&(this._queuedSyncs=null,this._needsSync=!0,this.sync((()=>{r.forEach((e=>e&&e()))}))),this.dispatchEvent(Yt),e&&e()}))))}onBeforeRender(e,t,r,n,a,o){this.sync(),a.isTroikaTextMaterial&&this._prepareForRender(a),a._hadOwnSide=a.hasOwnProperty("side"),this.geometry.setSide(a._actualSide=a.side),a.side=s.FrontSide}onAfterRender(e,t,r,n,a,o){a._hadOwnSide?a.side=a._actualSide:delete a.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=kt.clone());if(e&&e.baseMaterial===t||(e=this._derivedMaterial=function(e){const t=nt(e,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new s.Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new s.Vector4(0,0,0,0)},uTroikaClipRect:{value:new s.Vector4(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new s.Vector2},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new s.Color},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new s.Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:"\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform vec4 uTroikaTotalBounds;\nuniform vec4 uTroikaClipRect;\nuniform mat3 uTroikaOrient;\nuniform bool uTroikaUseGlyphColors;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaBlurRadius;\nuniform vec2 uTroikaPositionOffset;\nuniform float uTroikaCurveRadius;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nattribute vec3 aTroikaGlyphColor;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec3 vTroikaGlyphColor;\nvarying vec2 vTroikaGlyphDimensions;\n",vertexTransform:"\nvec4 bounds = aTroikaGlyphBounds;\nbounds.xz += uTroikaPositionOffset.x;\nbounds.yw -= uTroikaPositionOffset.y;\n\nvec4 outlineBounds = vec4(\n  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,\n  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius\n);\nvec4 clippedBounds = vec4(\n  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),\n  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)\n);\n\nvec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);\n\nposition.xy = mix(bounds.xy, bounds.zw, clippedXY);\n\nuv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);\n\nfloat rad = uTroikaCurveRadius;\nif (rad != 0.0) {\n  float angle = position.x / rad;\n  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);\n  normal.xz = vec2(sin(angle), cos(angle));\n}\n  \nposition = uTroikaOrient * position;\nnormal = uTroikaOrient * normal;\n\nvTroikaGlyphUV = clippedXY.xy;\nvTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);\n\n\nfloat txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;\nvec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;\nvec2 txStartUV = txUvPerSquare * vec2(\n  mod(floor(aTroikaGlyphIndex / 4.0), txCols),\n  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)\n);\nvTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);\nvTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);\n",fragmentDefs:"\nuniform sampler2D uTroikaSDFTexture;\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform float uTroikaSDFExponent;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaFillOpacity;\nuniform float uTroikaOutlineOpacity;\nuniform float uTroikaBlurRadius;\nuniform vec3 uTroikaStrokeColor;\nuniform float uTroikaStrokeWidth;\nuniform float uTroikaStrokeOpacity;\nuniform bool uTroikaSDFDebug;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec2 vTroikaGlyphDimensions;\n\nfloat troikaSdfValueToSignedDistance(float alpha) {\n  // Inverse of exponential encoding in webgl-sdf-generator\n  \n  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);\n  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;\n  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);\n  return signedDist;\n}\n\nfloat troikaGlyphUvToSdfValue(vec2 glyphUV) {\n  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);\n  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);\n  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1\n  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;\n}\n\nfloat troikaGlyphUvToDistance(vec2 uv) {\n  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));\n}\n\nfloat troikaGetAADist() {\n  \n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;\n  #else\n  return vTroikaGlyphDimensions.x / 64.0;\n  #endif\n}\n\nfloat troikaGetFragDistValue() {\n  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);\n  float distance = troikaGlyphUvToDistance(clampedGlyphUV);\n \n  // Extrapolate distance when outside bounds:\n  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : \n    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);\n\n  \n\n  return distance;\n}\n\nfloat troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {\n  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)\n  float alpha = step(-distanceOffset, -distance);\n  #else\n\n  float alpha = smoothstep(\n    distanceOffset + aaDist,\n    distanceOffset - aaDist,\n    distance\n  );\n  #endif\n\n  return alpha;\n}\n",fragmentColorTransform:"\nfloat aaDist = troikaGetAADist();\nfloat fragDistance = troikaGetFragDistValue();\nfloat edgeAlpha = uTroikaSDFDebug ?\n  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :\n  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));\n\n#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)\nvec4 fillRGBA = gl_FragColor;\nfillRGBA.a *= uTroikaFillOpacity;\nvec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);\nif (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;\ngl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(\n  -uTroikaStrokeWidth - aaDist,\n  -uTroikaStrokeWidth + aaDist,\n  fragDistance\n));\ngl_FragColor.a *= edgeAlpha;\n#endif\n\nif (edgeAlpha == 0.0) {\n  discard;\n}\n",customRewriter({vertexShader:e,fragmentShader:t}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(t)&&(t=t.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(e)||(e=e.replace(Ve,"uniform vec3 diffuse;\n$&\nvTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;\n"))),{vertexShader:e,fragmentShader:t}}});return t.transparent=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),t}(t),t.addEventListener("dispose",(function r(){t.removeEventListener("dispose",r),e.dispose()}))),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let t=e._outlineMtl;return t||(t=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),t.isTextOutlineMaterial=!0,t.depthWrite=!1,t.map=null,e.addEventListener("dispose",(function r(){e.removeEventListener("dispose",r),t.dispose()}))),[t,e]}return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return jt(this.material).getDepthMaterial()}get customDistanceMaterial(){return jt(this.material).getDistanceMaterial()}_prepareForRender(e){const t=e.isTextOutlineMaterial,r=e.uniforms,n=this.textRenderInfo;if(n){const{sdfTexture:e,blockBounds:a}=n;r.uTroikaSDFTexture.value=e,r.uTroikaSDFTextureSize.value.set(e.image.width,e.image.height),r.uTroikaSDFGlyphSize.value=n.sdfGlyphSize,r.uTroikaSDFExponent.value=n.sdfExponent,r.uTroikaTotalBounds.value.fromArray(a),r.uTroikaUseGlyphColors.value=!t&&!!n.glyphColors;let o,i,s,l=0,u=0,c=0,d=0,f=0;if(t){let{outlineWidth:e,outlineOffsetX:t,outlineOffsetY:r,outlineBlur:n,outlineOpacity:a}=this;l=this._parsePercent(e)||0,u=Math.max(0,this._parsePercent(n)||0),o=a,d=this._parsePercent(t)||0,f=this._parsePercent(r)||0}else c=Math.max(0,this._parsePercent(this.strokeWidth)||0),c&&(s=this.strokeColor,r.uTroikaStrokeColor.value.set(null==s?_t:s),i=this.strokeOpacity,null==i&&(i=1)),o=this.fillOpacity;r.uTroikaDistanceOffset.value=l,r.uTroikaPositionOffset.value.set(d,f),r.uTroikaBlurRadius.value=u,r.uTroikaStrokeWidth.value=c,r.uTroikaStrokeOpacity.value=i,r.uTroikaFillOpacity.value=null==o?1:o,r.uTroikaCurveRadius.value=this.curveRadius||0;let h=this.clipRect;if(h&&Array.isArray(h)&&4===h.length)r.uTroikaClipRect.value.fromArray(h);else{const e=100*(this.fontSize||.1);r.uTroikaClipRect.value.set(a[0]-e,a[1]-e,a[2]+e,a[3]+e)}this.geometry.applyClipRect(r.uTroikaClipRect.value)}r.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const a=t?this.outlineColor||0:this.color;if(null==a)delete e.color;else{const t=e.hasOwnProperty("color")?e.color:e.color=new s.Color;a===t._input&&"object"!=typeof a||t.set(t._input=a)}let o=this.orientation||Nt;if(o!==e._orientation){let t=r.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let n=o!==Nt&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(n){let[,e,r,a,o]=n;Ot.set(0,0,0)[r]="-"===e?1:-1,Pt.set(0,0,0)[o]="-"===a?-1:1,Lt.lookAt(Kt,Ot.cross(Pt),Pt),t.setFromMatrix4(Lt)}else t.identity();e._orientation=o}}_parsePercent(e){if("string"==typeof e){let t=e.match(/^(-?[\d.]+)%$/),r=t?parseFloat(t[1]):NaN;e=(isNaN(r)?0:r/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new s.Vector2){t.copy(e);const r=this.curveRadius;return r&&(t.x=Math.atan2(e.x,Math.abs(r)-Math.abs(e.z))*Math.abs(r)),t}worldPositionToTextCoords(e,t=new s.Vector2){return Ot.copy(e),this.localPositionToTextCoords(this.worldToLocal(Ot),t)}raycast(e,t){const{textRenderInfo:r,curveRadius:n}=this;if(r){const a=r.blockBounds,o=n?Xt():Qt(),i=o.geometry,{position:s,uv:l}=i.attributes;for(let e=0;e<l.count;e++){let t=a[0]+l.getX(e)*(a[2]-a[0]);const r=a[1]+l.getY(e)*(a[3]-a[1]);let o=0;n&&(o=n-Math.cos(t/n)*n,t=Math.sin(t/n)*n),s.setXYZ(e,t,r,o)}i.boundingSphere=this.geometry.boundingSphere,i.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,Jt.length=0,o.raycast(e,Jt);for(let e=0;e<Jt.length;e++)Jt[e].object=this,t.push(Jt[e])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,Zt.forEach((t=>{this[t]=e[t]})),this}clone(){return(new this.constructor).copy(this)}}Vt.forEach((e=>{const t="_private_"+e;Object.defineProperty(zt.prototype,e,{get(){return this[t]},set(e){e!==this[t]&&(this[t]=e,this._needsSync=!0)}})}));new WeakMap;new WeakMap;var qt=r(4881);const $t=i.forwardRef((({anchorX:e="center",anchorY:t="middle",font:r,fontSize:n=1,children:a,characters:o,onSync:s,...l},u)=>{const c=(0,Ae.z)((({invalidate:e})=>e)),[d]=i.useState((()=>new zt)),[f,h]=i.useMemo((()=>{const e=[];let t="";return i.Children.forEach(a,(r=>{"string"==typeof r||"number"==typeof r?t+=r:e.push(r)})),[e,t]}),[a]);return(0,qt.Rq)((()=>new Promise((e=>function({font:e,characters:t,sdfGlyphSize:r},n){Gt({font:e,sdfGlyphSize:r,text:Array.isArray(t)?t.join("\n"):""+t},n)}({font:r,characters:o},e)))),["troika-text",r,o]),i.useLayoutEffect((()=>{d.sync((()=>{c(),s&&s(d)}))})),i.useEffect((()=>()=>d.dispose()),[d]),i.createElement("primitive",(0,Me.Z)({object:d,ref:u,font:r,text:h,anchorX:e,anchorY:t,fontSize:n},l),f)}));var er=function(){return er=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},er.apply(this,arguments)},tr=function(e){var t,r,a,o,l,u,c,d,f,h,A,p=e.text,B=e.position,m=e.orientation,g=e.scale,v=void 0===g?1:g,C=(0,i.useMemo)((function(){var e,t=(new s.Euler).fromArray(m),r=s.MathUtils.radToDeg(t.z)+(null!==(e=null==p?void 0:p.decalRotation)&&void 0!==e?e:0);return t.z=s.MathUtils.degToRad(r),t}),[null==p?void 0:p.decalRotation,m]),y=ve((null===(a=null===(r=null===(t=null==p?void 0:p.material)||void 0===t?void 0:t.attributes)||void 0===r?void 0:r.images)||void 0===a?void 0:a.length)&&(null===(u=null===(l=null===(o=p.material.attributes.images[0])||void 0===o?void 0:o.image.data)||void 0===l?void 0:l.attributes)||void 0===u?void 0:u.url)?[p.material.attributes.images[0].image.data.attributes.url]:[])[0],b=(0,i.useMemo)((function(){return new s.Vector3(2*v,1*v,4)}),[v]),F=(null===(d=null===(c=null==p?void 0:p.outline)||void 0===c?void 0:c.attributes)||void 0===d?void 0:d.hex)?.06:0,M=null!==(A=null===(h=null===(f=null==p?void 0:p.outline)||void 0===f?void 0:f.attributes)||void 0===h?void 0:h.hex)&&void 0!==A?A:"#FFFFFF";return(0,n.jsx)(Te,er({position:B,rotation:C,scale:b},{children:(0,n.jsx)("meshStandardMaterial",er({transparent:!0,depthTest:!0,depthWrite:!1},{children:(0,n.jsxs)(Ie,er({attach:"map"},{children:[(0,n.jsx)(He,{makeDefault:!0,manual:!0,aspect:2,position:[0,0,5]}),(0,n.jsxs)($t,er({fontSize:2,anchorX:"center",anchorY:"middle",outlineColor:M,outlineWidth:F,color:y?void 0:"#000000",font:null==p?void 0:p.font},{children:[y&&(0,n.jsx)("meshBasicMaterial",{attach:"material",map:y}),null==p?void 0:p.text]}))]}))}))}))},rr=function(){return rr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},rr.apply(this,arguments)},nr=function(e){var t=e.geom,r=(0,a.b)((function(e){return e.flags})),o=(0,a.b)((function(e){return e.texts})),i=(0,a.b)((function(e){return e.graphics}));return(0,n.jsxs)("mesh",rr({geometry:t},{children:[(0,n.jsx)("meshStandardMaterial",{transparent:!0,colorWrite:!1}),r.map((function(e){if(e.decalPosition&&e.decalOrientation)return(0,n.jsx)(De,{flag:e,position:e.decalPosition,orientation:e.decalOrientation,scale:e.decalScale},e.key)})),i.map((function(e){if(e.decalPosition&&e.decalOrientation)return(0,n.jsx)(De,{graphic:e,position:e.decalPosition,orientation:e.decalOrientation,scale:e.decalScale},e.key)})),o.map((function(e){if(e.decalPosition&&e.decalOrientation)return(0,n.jsx)(tr,{text:e,position:e.decalPosition,orientation:e.decalOrientation,scale:e.decalScale},e.key)}))]}))};function ar(e){let t,r,n,a=0;for(let o=0;o<e.length;++o){const i=e[o];if(i.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=i.array.constructor),t!==i.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===r&&(r=i.itemSize),r!==i.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===n&&(n=i.normalized),n!==i.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;a+=i.array.length}const o=new t(a);let i=0;for(let t=0;t<e.length;++t)o.set(e[t].array,i),i+=e[t].array.length;return new s.BufferAttribute(o,r,n)}var or=function(){return or=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},or.apply(this,arguments)},ir=function(e){var t=e.children,r=(0,i.useState)(),n=r[0],a=r[1],o=(0,i.useMemo)((function(){var e=[];if(n)for(var t=0,r=Object.entries(n);t<r.length;t++){var a=r[t][1];a.isMesh&&e.push(a.geometry.clone())}return e.length?function(e,t=!1){const r=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),a=new Set(Object.keys(e[0].morphAttributes)),o={},i={},l=e[0].morphTargetsRelative,u=new s.BufferGeometry;let c=0;for(let s=0;s<e.length;++s){const d=e[s];let f=0;if(r!==(null!==d.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const e in d.attributes){if(!n.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===o[e]&&(o[e]=[]),o[e].push(d.attributes[e]),f++}if(f!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+". Make sure all geometries have the same number of attributes."),null;if(l!==d.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const e in d.morphAttributes){if(!a.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===i[e]&&(i[e]=[]),i[e].push(d.morphAttributes[e])}if(u.userData.mergedUserData=u.userData.mergedUserData||[],u.userData.mergedUserData.push(d.userData),t){let e;if(r)e=d.index.count;else{if(void 0===d.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+". The geometry must have either an index or a position attribute"),null;e=d.attributes.position.count}u.addGroup(c,e,s),c+=e}}if(r){let t=0;const r=[];for(let n=0;n<e.length;++n){const a=e[n].index;for(let e=0;e<a.count;++e)r.push(a.getX(e)+t);t+=e[n].attributes.position.count}u.setIndex(r)}for(const e in o){const t=ar(o[e]);if(!t)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+e+" attribute."),null;u.setAttribute(e,t)}for(const e in i){const t=i[e][0].length;if(0===t)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[e]=[];for(let r=0;r<t;++r){const t=[];for(let n=0;n<i[e].length;++n)t.push(i[e][n][r]);const n=ar(t);if(!n)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+e+" morphAttribute."),null;u.morphAttributes[e].push(n)}}return u}(e):null}),[n]);return t({addNodes:function(e,t){if(t){var r=or({},n);for(var o in e)delete r[o];a(or({},r))}else a((function(t){return or(or({},t),e)}))},geom:o})},sr=function(){return sr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},sr.apply(this,arguments)},lr=function(e){return e.selectedModels},ur=(0,i.forwardRef)((function(e,t){var r=e.onPointerDown,l=e.onPointerup,u=(0,a.b)(lr),c=(0,o.H)((function(e){return e.modelRotation})),d=(0,o.H)((function(e){return e.addingToCart}));return(0,i.useEffect)((function(){d&&"function"!=typeof t&&(null==t?void 0:t.current)&&t.current.rotateY(s.MathUtils.degToRad(c))}),[d,c]),(0,n.jsx)("group",sr({name:"meshGroup",ref:t,onPointerDown:r,onPointerUp:l,dispose:null},{children:(0,n.jsx)(ir,{children:function(e){var t=e.addNodes,r=e.geom;return(0,n.jsxs)(n.Fragment,{children:[u.map((function(e){var r;return(0,n.jsx)(Fe,{model:e.model,addNodes:t},null===(r=e.model)||void 0===r?void 0:r.id)})),r&&(0,n.jsx)(nr,{geom:r})]})}})}))}));ur.displayName="Scene";var cr=ur}}]);